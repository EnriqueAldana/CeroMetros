{"version":3,"sources":["meteor://ðŸ’»app/imports/startup/server/services/FirebaseAdmin.js","meteor://ðŸ’»app/imports/startup/server/services/MailServ.js","meteor://ðŸ’»app/imports/startup/server/utilities/FileOperations.js","meteor://ðŸ’»app/imports/startup/server/utilities/ResponseMesssage.js","meteor://ðŸ’»app/imports/startup/server/utilities/Utilities.js","meteor://ðŸ’»app/imports/startup/server/Permissions.js","meteor://ðŸ’»app/imports/startup/server/index.js","meteor://ðŸ’»app/imports/startup/both/index.js","meteor://ðŸ’»app/imports/api/Companies/Company.js","meteor://ðŸ’»app/imports/api/Companies/CompanyCtl.js","meteor://ðŸ’»app/imports/api/Companies/CompanyPubs.js","meteor://ðŸ’»app/imports/api/Companies/CompanyServ.js","meteor://ðŸ’»app/imports/api/Messages/Message.js","meteor://ðŸ’»app/imports/api/Messages/MessagePubs.js","meteor://ðŸ’»app/imports/api/Messages/MessageSeeder.js","meteor://ðŸ’»app/imports/api/Messages/MessagesCtl.js","meteor://ðŸ’»app/imports/api/Permissions/PermissionCtl.js","meteor://ðŸ’»app/imports/api/Permissions/PermissionPubs.js","meteor://ðŸ’»app/imports/api/ProductionLines/ProductionLine.js","meteor://ðŸ’»app/imports/api/ProductionLines/ProductionLineCtl.js","meteor://ðŸ’»app/imports/api/ProductionLines/ProductionLineSeeder.js","meteor://ðŸ’»app/imports/api/ProductionLines/ProductionLinesPubs.js","meteor://ðŸ’»app/imports/api/ProductionLines/ProductionLinesServ.js","meteor://ðŸ’»app/imports/api/Products/Product.js","meteor://ðŸ’»app/imports/api/Products/ProductCtl.js","meteor://ðŸ’»app/imports/api/Products/ProductPubs.js","meteor://ðŸ’»app/imports/api/Products/ProductSeeder.js","meteor://ðŸ’»app/imports/api/Products/ProductServ.js","meteor://ðŸ’»app/imports/api/Profiles/Profile.js","meteor://ðŸ’»app/imports/api/Profiles/ProfileCtl.js","meteor://ðŸ’»app/imports/api/Profiles/ProfileSeeder.js","meteor://ðŸ’»app/imports/api/Profiles/ProfilesPubs.js","meteor://ðŸ’»app/imports/api/Profiles/ProfilesServ.js","meteor://ðŸ’»app/imports/api/Providers/Provider.js","meteor://ðŸ’»app/imports/api/Providers/ProviderCtl.js","meteor://ðŸ’»app/imports/api/Providers/ProviderPubs.js","meteor://ðŸ’»app/imports/api/Providers/ProviderSeeder.js","meteor://ðŸ’»app/imports/api/Providers/ProviderServ.js","meteor://ðŸ’»app/imports/api/SystemOptions/SystemOptions.js","meteor://ðŸ’»app/imports/api/SystemOptions/SystemOptionsCtl.js","meteor://ðŸ’»app/imports/api/Users/User.js","meteor://ðŸ’»app/imports/api/Users/UserPresenceConfig.js","meteor://ðŸ’»app/imports/api/Users/UsersCtrl.js","meteor://ðŸ’»app/imports/api/Users/UsersPubs.js","meteor://ðŸ’»app/imports/api/Users/UsersServ.js","meteor://ðŸ’»app/imports/api/Warehouses/Warehouse.js","meteor://ðŸ’»app/imports/api/Warehouses/WarehouseCtl.js","meteor://ðŸ’»app/imports/api/Warehouses/WarehousePubs.js","meteor://ðŸ’»app/imports/api/Warehouses/WarehouseSeeder.js","meteor://ðŸ’»app/imports/api/Warehouses/WarehouseServ.js","meteor://ðŸ’»app/imports/api/Workstations/WorkStation.js","meteor://ðŸ’»app/imports/api/Workstations/WorkStationCtl.js","meteor://ðŸ’»app/imports/api/Workstations/WorkStationPubs.js","meteor://ðŸ’»app/imports/api/Workstations/WorkStationServ.js","meteor://ðŸ’»app/imports/middlewares/AuthGuard.js","meteor://ðŸ’»app/imports/middlewares/PermissionMiddleware.js","meteor://ðŸ’»app/server/main.js"],"names":["module","export","firebaseAdminsStorage","BASE_URL_STORAGE","firebaseAdmin","link","default","v","serviceAccount","initializeApp","credential","cert","storageBucket","storage","bucket","process","env","MAIL_URL","Meteor","settings","private","console","warn","SENDER_EMAIL","SENDER_EMAILS","CONTACT","LOGO_IMAGE_PATH","PRODUCT_IMAGE_PATH","info","name","email","from","emailEnrollAccount","emailResetPassword","emailVerifyEmail","productSrc","logoSrc","Accounts","emailTemplates","siteName","enrollAccount","subject","html","user","url","urlWithoutHash","replace","isDevelopment","SSR","compileTemplate","Assets","getText","render","resetPassword","verifyEmail","mimetypes","Utilities","ResponseMessage","exportDefault","saveFileFromBufferToGoogleStorage","fileBuffer","path","mimeType","responseMessage","versionFile","generateNumberToken","filename","detectExtension","file","fileUrl","save","metadata","contentType","public","create","success","exception","error","saveFileFromBase64ToGoogleStorage","base64file","match","base64EncodedImageString","split","pop","Buffer","deleteFileFromGoogleStoreIfExists","fileLocation","existsFile","exists","delete","deleteFilesOfFolderFromGoogleStorage","userFolder","deleteFiles","prefix","constructor","message","description","data","min","max","num","Math","floor","random","permissionsArray","Roles","Permissions","USERS","LIST","VALUE","TEXT","CREATE","UPDATE","DELETE","PROFILES","PERMISSIONS","ADMINS","LIST_ADMINS","CREATE_ADMIN","UPDATE_ADMIN","DELETE_ADMIN","SUPERADMINS","LIST_SUPER_ADMINS","CREATE_SUPER_ADMIN","UPDATE_SUPER_ADMIN","DELETE_SUPER_ADMIN","CHAT","COMPANIES","PRODUCTIONLINES","PRODUCTIONORDERS","PRODUCTS","PROVIDERSTATIONS","WAREHOUSES","WORKSTATIONS","PROVIDERS","Object","keys","reduce","accumulator","systemModuleName","systemModuleObject","modulePermissions","map","permission","concat","REFRESH_PERMISSIONS","log","currentRoles","getAllRoles","fetch","find","_role","_id","createRole","roles","update","$set","publicName","ValidatedMethod","check","methods","testmethod","suma","a","b","result","connectionData","userId","delayFunction","delayMessage","Promise","resolve","setTimeout","validate","Number","run","config","loginExpirationInDays","Company","Mongo","Collection","AuthGuard","CompanyServ","Match","mixins","MethodHooks","permissions","beforeHooks","checkPermission","company","OneOf","String","name_full","companyBussinessId","address","phones","web","isAvailable","Boolean","Error","validateCompanyBussinessId","validateCompanyName","insert","afterHooks","idCompany","userWithCompany","getUsersBycompany","length","remove","PermissionMiddleware","companyPublication","PublishEndpoint","param1","sort","createdAt","use","newCompanyBussinesId","existsCompany","findOne","oldCompany","newCompanyName","users","Message","messagesPublication","idContact","idUserLogged","$or","idSender","idReceiver","limit","date","rawCollection","createIndex","text","read","isUserLogged","messages","$in","m","multi","Profile","ex","idProfile","profile","$nin","scope","getScopesForUser","hasPermission","userIsInRole","publish","roleAssignment","ProductionLineRepository","ProductionLinesServ","WorkstationRepository","productionline","workstations","location","validateProductionLineName","productionlines","idProductionline","idProductionLine","workstationsAssigned","workstationsIncluded","workstation","workstationsAvailablesToInclude","found","i","j","push","unique","productionLinesPublication","newProductionLine","existsProductionLineName","filter","Product","ProductServ","product","unit","stock","provider","sku","warehouse","production_line","bom","quantity","validateProductName","bomList","idProduct","isUseredByWarehouse","productPublication","newProductName","existsProduct","oldProduct","ProfileServ","validateProfileName","oldProfile","getUsersByprofile","updateProfileUsers","userWithProfile","StaticProfiles","admin","p","REFRESH_STATIC_PROFILES","forEach","staticprofileName","upsert","setUserRoles","ProfilesServ","notStaticProfilePublication","getStaticprofilesName","profilePublication","idPrtofile","setUsersRoles","idUser","profileName","newProfileName","query","existsProfileName","Provider","ProviderServ","providerBussinessId","validateProviderBussinessId","validateProviderName","idProvider","toUseInToProduct","providerPublication","newProviderBussinesId","existsProvider","oldProvider","newProviderName","title","routeName","SystemOptions","userLogged","userRoles","getRolesForUser","optionOfUser","systemOption","role","User","SimpleSchema","require","UserProfileSchema","type","optional","blackbox","attachSchema","UserPresence","StatusSchema","status","onCleanup","sessionIds","$unset","onUserOnline","connection","Date","ipAddr","clientAddress","userAgent","httpHeaders","onUserIdle","onUserOffline","UsersServ","onCreateUser","options","customizedUser","assign","online","validateLoginAttempt","loginAttempt","allowed","emails","verified","loginTokensOfuser","services","resume","loginTokens","username","validateEmail","validateUserName","photoFileUser","updateuser","createUser","deleteUser","userPublication","FileOperations","PATH_USERS_FILENAME","newEmail","existsEmail","findUserByEmail","oldUser","newUserName","existsUserName","findUserByUsername","sendEnrollmentEmail","avatarSrc","response","currentUser","undefined","removeEmail","addEmail","sendVerificationEmail","setUsername","substring","lastIndexOf","WarehouseRepository","WarehouseServ","validateWarehouseName","idWarehouse","warehouseWithProduct","validateWarehouseBusy","warehousePublication","newWarehouseName","existsWarehouseList","WorkStationServ","validateWorkstationName","validateWorkstationChangeProductionLine","idWorkstation","workstationWithProductionLine","validateWorkstationBusy","workstationPublication","newWorkstationName","existsWorkstationList","existsWorkstationNumber","count","oldWorkstation","oldProductionLine","oldProductionLineWorkstationsUpdated","ws","methodArgs","methodOptions","PublishMiddleware","_permissions","added","collection","id","fields","arguments","ready","changed","removed","onReady","onStop","onError"],"mappings":"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","file":"/app.js","sourcesContent":["import firebaseAdmin from 'firebase-admin';\n\nimport serviceAccount from '../../../../settings/cerometros-firebase-adminsdk-ublo1-0e93050736.json';;\n\nfirebaseAdmin.initializeApp({\n    credential: firebaseAdmin.credential.cert(serviceAccount),\n    storageBucket: 'gs://cerometros.appspot.com'\n});\n\nexport const firebaseAdminsStorage = firebaseAdmin.storage().bucket('gs://cerometros.appspot.com');\nexport const BASE_URL_STORAGE='http://storage.googleapis.com';\n\n\n","/*\n*  Validar que la variable de entorno MAIL_URL este fijada\n*/\nif(!process.env.MAIL_URL){\n    if(Meteor.settings.private?.MAIL_URL){\n        process.env.MAIL_URL= Meteor.settings.private.MAIL_URL;\n    }else{\n        console.warn(\"El servicio de envio de correos no ha sido configurado -Variable de entorno MAIL_URL indefinida- , por lo que no se enviarÃ¡n correos.\");\n    }   \n}\nif (!process.env.SENDER_EMAIL){\n    if(Meteor.settings.private?.SENDER_EMAILS){\n        process.env.SENDER_EMAIL= Meteor.settings.private.SENDER_EMAILS.CONTACT;\n    }else{\n        console.warn(\"El servicio de envio de correos no ha sido configurado -Variable de entorno SENDER_EMAIL no definida- , por lo que no se enviarÃ¡n correos.\");\n    }\n}\n\nif(!process.env.LOGO_IMAGE_PATH){\n    process.env.LOGO_IMAGE_PATH=\"\";\n    console.warn(\"La ruta a la imagen del LOGO no ha sido configurado -Variable de entorno LOGO_IMAGEPATH- , por lo que no se visualizarÃ¡.\");\n}\nif(!process.env.PRODUCT_IMAGE_PATH){\n    process.env.PRODUCT_IMAGE_PATH=\"\";\n    console.warn(\"La ruta a la imagen del producto que lo identificano ha sido configurado -Variable de entorno PRODUCT_IMAGE__PATH - , por lo que no se visualizarÃ¡.\");\n}\nconsole.info(\" Configuracion del sistema de correo\");\nconsole.info(\" Email URL \",process.env.MAIL_URL);\nconsole.info(\" Email sender\",process.env.SENDER_EMAIL);\n\nconst name = 'Sistema CeroMetros';\nconst email = `<${process.env.SENDER_EMAIL}>`;\nconst from = `${ name } ${ email}`;\n\nconst emailEnrollAccount = 'email_enroll_account.html';\nconst emailResetPassword = 'email_reset_password.html';\nconst emailVerifyEmail = 'email_verify_email.html';\n//const productSrc = 'http://localhost:3000/img/vue-meteor.png';\n//const logoSrc = 'http://localhost:3000/img/Logo.png';\nconst productSrc = process.env.PRODUCT_IMAGE_PATH;\nconst logoSrc =process.env.LOGO_IMAGE_PATH;\nAccounts.emailTemplates.siteName = name;\nAccounts.emailTemplates.from = from;\nconst emailTemplates = Accounts.emailTemplates;\n\nemailTemplates.enrollAccount = {\n    subject() {\n        return `Bienvenido a ${name}`;\n    },\n    html(user,url) {\n        const urlWithoutHash = url.replace('#/','');\n        if(Meteor.isDevelopment) {\n            console.info('Link para fijar contraseÃ±a',urlWithoutHash);\n        }\n        SSR.compileTemplate('emailEnrollAccount',Assets.getText(emailEnrollAccount));\n        return SSR.render('emailEnrollAccount',{\n            urlWithoutHash,\n            productSrc,\n            logoSrc\n        });\n    }\n};\n\n\nemailTemplates.resetPassword = {\n    subject() {\n        return `Reestablecer contraseÃ±a`;\n    },\n    html(user,url) {\n        const urlWithoutHash = url.replace('#/','');\n        if(Meteor.isDevelopment) {\n            console.info('Link para reestablecer contraseÃ±a',urlWithoutHash);\n        }\n        SSR.compileTemplate('emailResetPassword',Assets.getText(emailResetPassword));\n        return SSR.render('emailResetPassword',{\n            urlWithoutHash,\n            productSrc,\n            logoSrc\n        });\n    }\n};\n\nemailTemplates.verifyEmail = {\n    subject() {\n        return `Validar correo electronico`;\n    },\n    html(user,url) {\n        const urlWithoutHash = url.replace('#/','');\n        if(Meteor.isDevelopment) {\n            console.info('Liga para validar correo electronico',urlWithoutHash);\n        }\n        SSR.compileTemplate('emailVerifyEmail',Assets.getText(emailVerifyEmail));\n        return SSR.render('emailVerifyEmail',{\n            urlWithoutHash,\n            productSrc,\n            logoSrc\n        });\n    }\n};\n\n\n","import mimetypes from 'mimetypes';\nimport Utilities from \"./Utilities\";\nimport { BASE_URL_STORAGE , firebaseAdminsStorage} from \"../services/FirebaseAdmin\";\nimport {ResponseMessage} from \"./ResponseMesssage\";\n\nexport default {\n    async saveFileFromBufferToGoogleStorage(fileBuffer, name, path ,mimeType) {\n        const responseMessage = new ResponseMessage();\n        const versionFile= Utilities.generateNumberToken(10,99);\n        const filename = `${ name }${ versionFile }.${ mimetypes.detectExtension(mimeType) }`;\n        const file = firebaseAdminsStorage.file(`${ path}/${ filename}`);\n        const fileUrl = `${ BASE_URL_STORAGE }/${ firebaseAdminsStorage.name }/${ path }/${ filename }`;\n        try{\n                await file.save(fileBuffer,{\n                    metadata: {\n                        contentType: mimeType\n                    },\n                    public: true\n                });\n                responseMessage.create('File uploaded',null,{success: true, fileUrl});\n\n        }catch(exception){\n            console.error('Error uploading file to Google Storage: ', exception);\n            responseMessage.create('Error uploading file to Google Storage',null,{success: false});\n        }\n        return responseMessage;\n    },\n    async saveFileFromBase64ToGoogleStorage(base64file,name,path){\n        const mimeType = base64file.match(/data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/)[1];\n        const base64EncodedImageString= base64file.split(';base64,').pop();\n        const fileBuffer= Buffer.from(base64EncodedImageString,'base64');\n        return await this.saveFileFromBufferToGoogleStorage(fileBuffer,name,path,mimeType);\n    },\n    async deleteFileFromGoogleStoreIfExists(fileLocation){\n        const file = firebaseAdminsStorage.file(fileLocation);\n        try{\n            const existsFile = await file.exists();\n            if(existsFile[0]){\n                    await file.delete();\n            }\n        }catch(exception){\n            console.error('Ha habido un error al borrar archivo de Google Store', exception);\n        }\n\n    },\n    async deleteFilesOfFolderFromGoogleStorage(userFolder) {\n        try {\n            await firebaseAdminsStorage.deleteFiles({prefix: userFolder + '/'});\n        } catch (exception) {\n            console.error('Error deleting files from Google Storage');\n        }\n    }\n}\n","export class ResponseMessage {\n    constructor(){\n        this.message=null;\n        this.description = null;\n        this.data=null;\n    }\n\n    create(message,description =null,data =null){\n        this.message=message;\n        this.description=description;\n        this.data=data;\n\n    }\n}","export default {\n\n    generateNumberToken(min, max) {\n        //console.log('min ', min);\n        //console.log('max ',max);\n        const num= Math.floor(Math.random() * (max+1-min) +min );\n        //console.log('random ' , num);\n        return num;\n    }\n};\n\n","import { Roles } from 'meteor/alanning:roles';\n\n\nconst Permissions={\n    USERS:{\n        LIST:{VALUE:'users-view',TEXT:'Listar usuarios'},\n        CREATE:{VALUE:'users-create',TEXT:'Crear Usuario'},\n        UPDATE:{VALUE:'users-edit',TEXT:'Editar Usuario'},\n        DELETE:{VALUE:'users-delete',TEXT:'Borrar Usuario'}\n    },\n    PROFILES:{\n        LIST:{VALUE:'profiles-view',TEXT:'Listar perfil'},\n        CREATE:{VALUE:'profiles-create',TEXT:'Crear perfil'},\n        UPDATE:{VALUE:'profiles-edit',TEXT:'Editar perfil'},\n        DELETE:{VALUE:'profiles-delete',TEXT:'Borrar perfil'}\n    },\n    PERMISSIONS:{\n        LIST:{VALUE:'permissions-view',TEXT:'Listar permisos'}\n    },\n    ADMINS:{\n        LIST_ADMINS:{VALUE:'admins-view',TEXT:'Listar administrador'},\n        CREATE_ADMIN:{VALUE:'admins-create',TEXT:'Crear administrador'},\n        UPDATE_ADMIN:{VALUE:'admins-edit',TEXT:'Editar administrador'},\n        DELETE_ADMIN:{VALUE:'admins-delete',TEXT:'Borrar administrador'}\n    },\n    SUPERADMINS:{\n        LIST_SUPER_ADMINS:{VALUE:'superadmins-view',TEXT:'Listar super administrador'},\n        CREATE_SUPER_ADMIN:{VALUE:'superadmins-create',TEXT:'Crear super administrador'},\n        UPDATE_SUPER_ADMIN:{VALUE:'superadmins-edit',TEXT:'Editar super administrador'},\n        DELETE_SUPER_ADMIN:{VALUE:'superadmins-delete',TEXT:'Borrar super administrador'}\n\n    },\n    CHAT: {\n        CREATE: { VALUE: 'message-create', TEXT: 'Enviar mensaje de chat'},\n        LIST: { VALUE: 'message-view', TEXT: 'Ver mensajes de chat'}\n    },\n    COMPANIES:{\n        LIST:{VALUE:'companies-view',TEXT:'Listar compaÃ±ias'},\n        CREATE:{VALUE:'companies-create',TEXT:'Crear compaÃ±ias'},\n        UPDATE:{VALUE:'companies-edit',TEXT:'Editar compaÃ±ias'},\n        DELETE:{VALUE:'companies-delete',TEXT:'Borrar compaÃ±ias'}\n\n    },\n    PRODUCTIONLINES:{\n        LIST:{VALUE:'productionlines-view',TEXT:'Listar linea de produccion'},\n        CREATE:{VALUE:'productionlines-create',TEXT:'Crear linea de produccion'},\n        UPDATE:{VALUE:'productionlines-edit',TEXT:'Editar linea de produccion'},\n        DELETE:{VALUE:'productionlines-delete',TEXT:'Borrar linea de produccion'}\n\n    },\n    PRODUCTIONORDERS:{\n        LIST:{VALUE:'productionorders-view',TEXT:'Listar orden de produccion'},\n        CREATE:{VALUE:'productionorders-create',TEXT:'Crear ordenes de produccion'},\n        UPDATE:{VALUE:'productionorders-edit',TEXT:'Editar orden de produccion'},\n        DELETE:{VALUE:'productionorders-delete',TEXT:'Borrar orden de produccion'}\n\n    },\n    PRODUCTS:{\n        LIST:{VALUE:'products-view',TEXT:'Listar productos'},\n        CREATE:{VALUE:'products-create',TEXT:'Crear productos'},\n        UPDATE:{VALUE:'products-edit',TEXT:'Editar producto'},\n        DELETE:{VALUE:'products-delete',TEXT:'Borrar producto'}\n\n    },\n    PROVIDERSTATIONS:{\n        LIST:{VALUE:'providerstations-view',TEXT:'Listar estaciones de suministro'},\n        CREATE:{VALUE:'providerstations-create',TEXT:'Crear estacion de suministro'},\n        UPDATE:{VALUE:'providerstations-edit',TEXT:'Editar estacion de suministro'},\n        DELETE:{VALUE:'providerstations-delete',TEXT:'Borrar estacion de suministro'}\n\n    },\n    WAREHOUSES:{\n        LIST:{VALUE:'warehouses-view',TEXT:'Listar almacenes'},\n        CREATE:{VALUE:'warehouses-create',TEXT:'Crear almacen'},\n        UPDATE:{VALUE:'warehouses-edit',TEXT:'Editar almacen'},\n        DELETE:{VALUE:'warehouses-delete',TEXT:'Borrar almacen'}\n\n    },\n    WORKSTATIONS:{\n        LIST:{VALUE:'workstations-view',TEXT:'Listar estaciones de trabajo'},\n        CREATE:{VALUE:'workstations-create',TEXT:'Crear estacion de trabajo'},\n        UPDATE:{VALUE:'workstations-edit',TEXT:'Editar estacion de trabajo'},\n        DELETE:{VALUE:'workstations-delete',TEXT:'Borrar estacion de trabajo'}\n\n    },\n    PROVIDERS:{\n        LIST:{VALUE:'providers-view',TEXT:'Listar proveedores'},\n        CREATE:{VALUE:'providers-create',TEXT:'Crear proveedore'},\n        UPDATE:{VALUE:'providers-edit',TEXT:'Editar proveedore'},\n        DELETE:{VALUE:'providers-delete',TEXT:'Borrar proveedore'}\n\n    },\n\n};\n\nexport const permissionsArray= Object.keys(Permissions).reduce((accumulator, systemModuleName)=>{\n    const systemModuleObject= Permissions[systemModuleName];\n    const modulePermissions= Object.keys(systemModuleObject).map(permission=> systemModuleObject[permission]);\n    return accumulator.concat(modulePermissions);\n},[]);\n\n/*\nDevuelve esto:\n\n[\n  { VALUE: 'users-view', TEXT: 'Listar usuarios' },\n  { VALUE: 'users-create', TEXT: 'Crear Usuario' },\n  { VALUE: 'users-edit', TEXT: 'Editar Usuario' },\n  { VALUE: 'users-delete', TEXT: 'Borrar Usuario' },\n  { VALUE: 'users-admin', TEXT: 'Administrar  Usuarios' },\n  { VALUE: 'users-super-admin', TEXT: 'Super usuario' }\n]\n\n */\nif(Meteor.settings.private && Meteor.settings.private.REFRESH_PERMISSIONS){\n    console.log(' Updating permissions...');\n    const currentRoles= Roles.getAllRoles().fetch();\n    for(let permission of permissionsArray){\n        let exists= currentRoles.find(_role=> _role._id==permission.VALUE)\n        if(!exists){\n            Roles.createRole(permission.VALUE);\n        }else{\n            Meteor.roles.update(permission.VALUE, {\n                $set:{\n                    publicName:permission.TEXT\n    \n                }\n            });\n        }\n        \n    }\n}else{\n    console.log('Not Updating permissions...');\n}\n\nexport default Permissions;\n\n// https://github.com/Meteor-Community-Packages/meteor-roles","import './Permissions';\nimport './services/MailServ';\nimport '../../api/Users/UsersCtrl';\nimport '../../api/Users/User';\nimport '../../api/Users/UsersPubs';\nimport '../../api/Profiles/ProfileSeeder';\nimport '../../api/Profiles/ProfileCtl';\nimport '../../api/Profiles/ProfilesServ';\nimport '../../api/Profiles/ProfilesPubs';\nimport '../../api/Permissions/PermissionCtl';\nimport '../../api/Permissions/PermissionPubs';\nimport '../../api/SystemOptions/SystemOptionsCtl';\nimport '../server/services/FirebaseAdmin';\nimport '../../api/Messages/Message';\nimport '../../api/Messages/MessagesCtl';\nimport '../../api/Messages/MessagePubs';\nimport '../../api/Messages/MessageSeeder';\nimport '../../api/Companies/Company';\nimport '../../api/Companies/CompanyCtl';\nimport '../../api/Companies/CompanyPubs';\nimport '../../api/Companies/CompanyServ';\nimport '../../api/Workstations/WorkStation';\nimport '../../api/Workstations/WorkStationCtl';\nimport '../../api/Workstations/WorkStationPubs';\nimport '../../api/Workstations/WorkStationServ';\nimport '../../api/ProductionLines/ProductionLine';\nimport '../../api/ProductionLines/ProductionLineCtl';\nimport '../../api/ProductionLines/ProductionLinesPubs';\nimport '../../api/ProductionLines/ProductionLinesServ';\nimport '../../api/ProductionLines/ProductionLineSeeder';\nimport '../../api/Warehouses/Warehouse';\nimport '../../api/Warehouses/WarehouseCtl';\nimport '../../api/Warehouses/WarehousePubs';\nimport '../../api/Warehouses/WarehouseSeeder';\nimport '../../api/Warehouses/WarehouseServ';\nimport '../../api/Providers/Provider';\nimport '../../api/Providers/ProviderCtl';\nimport '../../api/Providers/ProviderPubs';\nimport '../../api/Providers/ProviderSeeder';\nimport '../../api/Providers/ProviderServ';\nimport '../../api/Products/Product';\nimport '../../api/Products/ProductCtl';\nimport '../../api/Products/ProductPubs';\nimport '../../api/Products/ProductSeeder';\nimport '../../api/Products/ProductServ';\n\n\n\n// Ejemplos de creacion de metodos o End Points\nimport {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {check} from 'meteor/check';\nMeteor.methods( {\n    testmethod(){\n        console.log('Hola mundo')\n        return 'Este es un end point';\n    },\n    suma(a,b){\n        return {result: a +  b};\n    },\n    connectionData(){\n        console.log(this);\n        if(userId){\n            console.log('Ususario logeado');\n        }else {\n            console.log('Usuario no esta logeado');\n\n        }\n        /*\n        Datos del contexto\n\n            I20210219-17:16:23.677(-6)?   isSimulation: false,\n            I20210219-17:16:23.677(-6)?   _unblock: [Function],\n            I20210219-17:16:23.677(-6)?   _calledUnblock: false,\n            I20210219-17:16:23.678(-6)?   userId: null,\n            I20210219-17:16:23.678(-6)?   _setUserId: [Function: setUserId],\n            I20210219-17:16:23.678(-6)?   connection: null,\n            I20210219-17:16:23.678(-6)?   randomSeed: null,\n            I20210219-17:16:23.678(-6)?   randomStream: null\n            I20210219-17:16:23.678(-6)? }\n\n         */\n\n    }, async delayFunction() {\n                let delayMessage = 'Antes';\n                await new Promise(  resolve => {\n                        setTimeout(()=>{\n                            delayMessage = \"Despues\";\n                            resolve(1);\n                        },2000)\n        });\n\n                return delayMessage;\n        }\n})\n\nnew ValidatedMethod( {\n    name:'multiplicacion',\n    validate({a,b}){\n        check(a,Number);\n        check(b, Number);\n\n    },run({a,b}){\n        return {result: a*b};\n        }\n}\n);\n\nnew ValidatedMethod( {\n    name:'multiplication',\n        validate: null,\n    run({a,b}){  // se ej\n    return { result: a*b};\n\n    }\n});\n","Accounts.config({\n    loginExpirationInDays:1  // Numero de dias para expirar el token\n});","import { Mongo } from 'meteor/mongo';\n\nexport const Company = new Mongo.Collection('companies');","import {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport {Company} from \"./Company\";\nimport CompanyServ from \"./CompanyServ\";\nimport {check, Match} from \"meteor/check\";\n\nnew ValidatedMethod({\n    name:'company.save',\n     mixins:[MethodHooks],\n     permissions: [Permissions.COMPANIES.CREATE.VALUE,Permissions.COMPANIES.UPDATE.VALUE],  \n     beforeHooks: [AuthGuard.checkPermission],\n    validate(company){\n        try {\n            console.log(\"Obj Empresa\",company);\n            check(company,{\n                _id: Match.OneOf(String, null),\n                name: String,\n                name_full: String,\n                companyBussinessId: String,\n                address: String,\n                phones: String,\n                web: String,\n                email: String,\n                isAvailable: Boolean\n            });\n\n        }catch ( exception){\n            console.error('company.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es valida');\n        }\n        // Validar que no haya compaÃ±ias con el mismo nombre y BussinesID\n        CompanyServ.validateCompanyBussinessId(company.companyBussinessId,company._id);\n        CompanyServ.validateCompanyName(company.name,company._id);\n    },\n    run(company){\n        const responseMessage = new ResponseMessage(); \n        try {\n            if(company._id !== null){\n                Company.update(company._id,{\n                    $set: {\n                    name: company.name,\n                    name_full: company.name_full,\n                    companyBussinessId: company.companyBussinessId,\n                    address: company.address,\n                    phones: company.phones,\n                    web: company.web,\n                    email: company.email,\n                    isAvailable: company.isAvailable\n                    }\n                });\n                responseMessage.create('Se actualizÃ³ la empresa exitosamente');\n            }else{\n                Company.insert({\n                    name: company.name,\n                    name_full: company.name_full,\n                    companyBussinessId: company.companyBussinessId,\n                    address: company.address,\n                    phones: company.phones,\n                    web: company.web,\n                    email: company.email,\n                    isAvailable: company.isAvailable\n                });\n                responseMessage.create('Se insertÃ³ la empresa exitosamente');\n            }\n        }catch ( exception){\n            console.error('company.save', exception);\n            throw new Meteor.Error('500', 'Ha ocurrido un error al guardar la empresa');\n        }\n        return responseMessage;\n    }\n });\n\nnew ValidatedMethod({\n    name: 'company.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.COMPANIES.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({ idCompany }){\n        try {\n            check(idCompany, String);\n        }catch (exception) {\n            console.error('company.delete', exception);\n            throw new Meteor.Error('403', 'Ocurrio un error al eliminar la compaÃ±ia');\n        }\n        // validar que no sea posible eliminar una empresa si hay un usuario utilizandolo.\n        const userWithCompany = CompanyServ.getUsersBycompany(idCompany);\n\n        if (userWithCompany.length > 0){\n            throw new Meteor.Error('403','No es posible elimiar la empresa',\n                'Hay al menos un usuario utilizando la empresa');\n        }\n    },\n    run({ idCompany }){\n        const responseMessage = new ResponseMessage();\n        try {\n                Company.remove(idCompany);\n                responseMessage.create('CompaÃ±ia eliminada exitosamente');\n        }catch (exception) {\n            console.error('profile.delete', exception);\n            throw new Meteor.Error('500', 'Ocurrio un error al eliminar la empresa');\n        }\n\n        return responseMessage;\n    }\n});\n","import { Company } from './Company';\nimport { PermissionMiddleware } from '../../middlewares/PermissionMiddleware';\nimport Permissions from '../../startup/server/Permissions';\n\nconst companyPublication=new PublishEndpoint('company.list',function(param1){\n        return Company.find({},{\n                sort:{createdAt: -1}\n        });\n});\n\ncompanyPublication.use(new PermissionMiddleware(Permissions.COMPANIES.LIST.VALUE));","\nimport {Meteor} from \"meteor/meteor\";\nimport {Company} from \"./Company\";\n\nexport default {\n\n    validateCompanyBussinessId(newCompanyBussinesId,idCompany){\n\n        const existsCompany= Company.findOne({companyBussinessId:newCompanyBussinesId});\n        if(idCompany !== null){  // actualizacion de CompaÃ±ia\n            const oldCompany= Company.findOne(idCompany);\n            if(oldCompany.companyBussinessId !== newCompanyBussinesId && existsCompany){\n                throw new Meteor.Error('403', 'El nuevo RFC de empresa ya esta siendo usado');\n            }\n        }else if(existsCompany){ // es compaÃ±ia nuevo pero el CompanyBussinesId  ya existe.\n                throw new Meteor.Error('403', 'El nuevo RFC de empresa  ya esta siendo utilizado');\n\n        }\n\n    },\n    validateCompanyName(newCompanyName,idCompany){\n        const existsCompany= Company.findOne({name:newCompanyName});\n        if(idCompany !== null){  // actualizacion de CompaÃ±ia\n            const oldCompany= Company.findOne(idCompany);\n            if(oldCompany.name !== newCompanyName && existsCompany){\n                throw new Meteor.Error('403', 'El nuevo nombre de empresa ya esta siendo usado');\n            }\n        }else if(existsCompany){ // es compaÃ±ia nuevo pero el CompanyBussinesId  ya existe.\n                throw new Meteor.Error('403', 'El nuevo nombre de empresa  ya esta siendo utilizado');\n\n        }\n    },\n    getUsersBycompany(idCompany){\n        const company = Company.findOne(idCompany);\n        return Meteor.users.find({'companyName':company.name}).fetch();\n    }\n}","import { Mongo } from 'meteor/mongo';\n\nexport const Message = new Mongo.Collection('messages');\n","import { Message } from './Message';\nimport { PermissionMiddleware } from '../../middlewares/PermissionMiddleware';\nimport Permissions from '../../startup/server/Permissions';\n\nconst messagesPublication = new PublishEndpoint('message.list', function(idContact = null){\n    const idUserLogged = this.userId;\n    return Message.find({\n        $or: [\n            {idSender: idUserLogged, idReceiver: idContact},\n            {idSender: idContact, idReceiver: idUserLogged}\n        ]\n    },{\n        limit:20,\n        sort:{\n           date:-1 \n        }\n    });\n});\n\nmessagesPublication.use(new PermissionMiddleware(Permissions.CHAT.LIST.VALUE));","import { Message } from './Message';\n\nMessage.rawCollection().createIndex({ idSender: 1});\nMessage.rawCollection().createIndex({ idReceiver: 1});\nMessage.rawCollection().createIndex({ date: 1});","import {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {check} from 'meteor/check';\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport {Message} from \"./Message\";\n\nnew ValidatedMethod({\n    name:'message.save',\n     mixins:[MethodHooks],\n     permissions: [Permissions.CHAT.CREATE.VALUE],  \n     beforeHooks: [AuthGuard.checkPermission],\n    validate(message){\n        try {\n            check(message,{\n                idSender: String,\n                idReceiver: String,\n                text: String,\n                date: String,\n                read: Boolean\n            });\n\n        }catch ( exception){\n            console.error('message.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es valida');\n        }\n    },\n    run(message){\n        const responseMessage = new ResponseMessage();\n        \n        try {\n            Message.insert(message);\n            responseMessage.create('Se insertÃ³ el mensaje exitosamente');\n       \n        }catch ( exception){\n            console.error('message.save', exception);\n            throw new Meteor.Error('500', 'Ha ocurrido un error al guardar el mensaje');\n        }\n        return responseMessage;\n    }\n });\n\n new ValidatedMethod({\n    name:'messages.read',\n     mixins:[MethodHooks],  \n     beforeHooks: [AuthGuard.isUserLogged],\n    validate(messages){\n        try {\n            check(messages,[\n               { \n                _id: String,\n                idSender: String,\n                idReceiver: String,\n                text: String,\n                date: String,\n                read: Boolean\n            }\n            ]);\n\n        }catch ( exception){\n            console.error('message.read', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es valida');\n        }\n    },\n    run(messages){\n        const responseMessage = new ResponseMessage();\n        \n        try {\n            Message.update({_id:{ $in: messages.map(m => m._id) } },{\n                $set: {\n                    read: true\n                }\n            }, {multi: true});\n        \n        }catch ( exception){\n            console.error('message.read', exception);\n            throw new Meteor.Error('500', 'Ha ocurrido un error al marcar los mensajes como leidos');\n        }\n        return responseMessage;\n    }\n });","\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\"\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport {check, Match} from \"meteor/check\";\nimport {Meteor} from \"meteor/meteor\";\nimport {Profile} from \"../Profiles/Profile\";\n\nnew ValidatedMethod({\n    name:'permissions.list',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PERMISSIONS.LIST.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],\n    validate: null,\n    run() {\n        const responseMessage = new ResponseMessage();\n        try{\n            const permissions = Meteor.roles.find().fetch();\n            responseMessage.create('Permisos disponibles del sistema',null,permissions);\n        }catch(ex){\n            console.log('permissions.list: ', ex);\n            throw new Meteor.Error('500','OcurriÃ³ un error al obtener la lista de permisos');\n        }\n\n        return responseMessage;\n    }\n\n});\n\nnew ValidatedMethod({\n    name:'permissions.listByIdProfile',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PERMISSIONS.LIST.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],\n    validate({idProfile}) {\n            try{\n                check('idProfile',String);\n            }catch (exception) {\n                    console.error('user.remove', exception);\n                    throw new Meteor.Error('403','La informacion proporcionada no es correcta');\n            }\n    },\n    run(idProfile) {\n        const responseMessage = new ResponseMessage();\n        try{\n            let permissions= [];\n            const profile= Profile.findOne({'_id':idProfile.idProfile});\n            if(profile){\n                permissions=Meteor.roles.find({'_id':{$in:profile.permissions}}).fetch();\n            }\n            responseMessage.create('Permisos asociados al perfil','Permisos incluidos en el perfil',permissions);\n        }catch(ex){\n            console.log('permissions.listByIdProfile: ', ex);\n            throw new Meteor.Error('500','OcurriÃ³ un error al obtener la lista de permisos asociados a un perfil');\n        }\n\n        return responseMessage;\n    }\n\n});\n\nnew ValidatedMethod({\n    name:'permissions.listOfOthers',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PERMISSIONS.LIST.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],\n    validate({idProfile}) {\n        try{\n            check('idProfile',String);\n        }catch (exception) {\n            console.error('permissions.listOfOthers', exception);\n            throw new Meteor.Error('403','La informacion proporcionada no es correcta');\n        }\n    },\n    run(idProfile) {\n        const responseMessage = new ResponseMessage();\n        try{\n            let permissions= [];\n            const profile= Profile.findOne({'_id':idProfile.idProfile});\n            if(profile){\n                permissions=Meteor.roles.find({'_id':{$nin:profile.permissions}}).fetch();\n            }\n            responseMessage.create('Permisos NO asociados al perfil','Permisos NO incluidos en el perfil',permissions);\n        }catch(ex){\n            console.log('permissions.listOfOthers: ', ex);\n            throw new Meteor.Error('500','OcurriÃ³ un error al obtener la lista de permisos NO asociados a un perfil');\n        }\n\n        return responseMessage;\n    }\n\n});\n\nnew ValidatedMethod({\n    name: 'permissions.check',\n    mixins: [MethodHooks],\n    beforeHooks: [AuthGuard.isUserLogged],\n    validate(permission){\n        try{\n            check(permission,String);\n        }catch(exception){\n            console.error('permissions.check',exception);\n            throw new Meteor.Error('403', 'La informaciÃ³n introducida no es valida.');\n        }       \n    },\n    run(permission){\n        const responseMessage = new ResponseMessage();\n        try{\n\n            const scope = Roles.getScopesForUser(this.userId)[0];\n            const hasPermission=Roles.userIsInRole(this.userId,permission,scope);\n            responseMessage.create(` El usuario {$hasPermission?'si','no'} el permiso`,null,{hasPermission});\n        }catch(exception){\n            console.error('permissions.check',exception);\n            throw new Meteor.Error('500', ' Ha ocurrido un error al verificar el permiso ');\n        }\n        return responseMessage;\n    }\n});","Meteor.publish('roles',function(){\n  return Meteor.roleAssignment.find({'user._id':this.userId});\n});","import { Mongo } from 'meteor/mongo';\nexport const ProductionLineRepository = new Mongo.Collection('productionlines');","import {check, Match} from \"meteor/check\";\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport {ProductionLineRepository} from \"./ProductionLine\";\nimport ProductionLinesServ from \"./ProductionLinesServ\";\nimport {WorkstationRepository} from '../Workstations/WorkStation'\n\nnew ValidatedMethod({\n    name: 'productionline.save',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PRODUCTIONLINES.CREATE.VALUE,Permissions.PRODUCTIONLINES.UPDATE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate(productionline) {\n        console.info('productionline', productionline);\n        try {\n            // Valida que la estructura del objeto user este conforme a la definicion.\n            check(productionline, {\n                _id: Match.OneOf(String, null),\n                name: String,\n                description: String,\n                workstations: [\n                    {\n                        _id: Match.OneOf(String, null),\n                        name: String,\n                        name_full: String,\n                        location: String,\n                        productionline: {\n                            description : String,\n                            name : String,\n                            _id : String\n                        }\n                    }\n                ]\n            });\n        } catch (exception) {\n            console.error('productionline.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es vÃ¡lida.');\n        }\n        ProductionLinesServ.validateProductionLineName(productionline.name,productionline._id);\n    \n     \n    },\n    run(productionline) {\n        console.log('productionline.save');\n        const responseMessage= new ResponseMessage();\n        if(productionline._id !==null){\n            try{\n                ProductionLineRepository.update(productionline._id,{\n                    $set:{\n                        name: productionline.name,\n                        description: productionline.description,\n                        workstations: productionline.workstations\n                    }\n                });\n\n                console.log('Se ha actualizado la linea de produccion');\n                responseMessage.create('Se ha actualizado la linea de produccion');\n            }catch (exception) {\n                console.error('productionline.save', exception);\n                throw new Meteor.Error('500', 'OcurriÃ³ un error al actualizar la linea de produccion');\n            }\n        }else{\n            console.log('productionline: ',productionline);\n            try{\n                ProductionLineRepository.insert({\n                    name: productionline.name,\n                    description: productionline.description,\n                    workstations: productionline.workstations\n                });\n                console.log('Se ha guardado la linea de produccion');\n                responseMessage.create('Se ha guardado la linea de produccion');\n            }catch (exception) {\n                console.error('productionline.save', exception);\n                throw new Meteor.Error('500', 'OcurriÃ³ un error al guardar la linea de produccion');\n            }\n        }\n        return responseMessage;\n    }\n});\n\nnew ValidatedMethod({\n    name: 'productionline.list',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PRODUCTIONLINES.LIST.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate() {\n    },\n    run() {\n        console.log('productionline.list');\n        const responseMessage= new ResponseMessage();\n            try{\n            const productionlines = ProductionLineRepository.find().fetch();\n                responseMessage.create('Se ha obtenido la lista de lineas de produccion',null,productionlines);\n            }catch (exception) {\n                console.error('productionline.save', exception);\n                throw new Meteor.Error('500', 'OcurriÃ³ un error al obtener las linea de produccion');\n            }\n        \n        return responseMessage;\n    }\n});\n\nnew ValidatedMethod({\n    name: 'productionline.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PRODUCTIONLINES.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({ idProductionline }){\n        try {\n            check(idProductionline, String);\n        }catch (exception) {\n            console.error('productionline.delete', exception);\n            throw new Meteor.Error('403', 'Ocurrio un error al eliminar la linea de produccion');\n        }\n        // validar que no sea posible eliminar una linea de produccion si hay una orden de produccion ACTIVA utilizandolo.\n        \n    },\n    run({ idProductionline }){\n        const responseMessage = new ResponseMessage();\n        try {\n            ProductionLineRepository.remove(idProductionline);\n            responseMessage.create('Linea de produccion eliminada exitosamente');\n        }catch (exception) {\n            console.error('profile.delete', exception);\n            throw new Meteor.Error('500', 'Ocurrio un error al eliminar la linea de produccion');\n        }\n        return responseMessage;\n    }\n});\n\nnew ValidatedMethod({\n    name:'productionline.workstations.availables.to.include',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PRODUCTIONLINES.LIST.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],\n    validate(idProductionLine) {\n            try{\n                console.info('idProductionLine',idProductionLine);\n                check('idProductionLine',String);\n            }catch (exception) {\n                    console.error('productionline.workstations', exception);\n                    throw new Meteor.Error('403','La informacion proporcionada no es correcta');\n            }\n    },\n    run(idProductionLine) {\n        const responseMessage = new ResponseMessage();\n        try{\n            let workstationsAssigned= [];\n            let workstationsIncluded= [];\n            const productionline= ProductionLineRepository.findOne({'_id':idProductionLine});\n            if(productionline){\n                workstationsAssigned=  WorkstationRepository.find({'productionline._id':idProductionLine}).fetch();\n                workstationsIncluded=  WorkstationRepository.find({'_id': {$in: productionline.workstations.map(workstation => workstation._id)}}).fetch();\n            }\n            let workstationsAvailablesToInclude=[];\n            var found = false;\n            for(var i = 0; i < workstationsAssigned.length; i++) {\n                for(var j = 0; j < workstationsIncluded.length; j++){\n                    if (workstationsAssigned[i]._id == workstationsIncluded[j]._id){\n                        found =true;\n                        break;\n                    }   \n                }\n                if(!found){\n                    workstationsAvailablesToInclude.push(workstationsAssigned[i]);\n                }\n                found = false;\n            }\n            \n           // console.info('workstationsAssigned',workstationsAssigned);\n           // console.info('workstationsIncluded',workstationsIncluded);\n           //  console.info('workstationsAvailablesToInclude', workstationsAvailablesToInclude);\n            \n            // El tercer parametro equivaldra al objeto data en el response\n            responseMessage.create('Estaciones de trabajo asociadas a la linea de produccion disponibles para incluir','Estaciones disponibles para incluir en la linea de prod',workstationsAvailablesToInclude);\n        }catch(ex){\n            console.log('workstations.listByIdProductionLine: ', ex);\n            throw new Meteor.Error('500','OcurriÃ³ un error al obtener la lista de estaciones de trabajo asociadas a una linea de produccion disponibles para incluir');\n        }\n\n        return responseMessage;\n    }\n\n});\n\n/*\n* Aqui devolver las estaciones de trabajo que esten\n* incluidas en la linea\n*/\nnew ValidatedMethod({\n    name:'productionline.workstations.included',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PRODUCTIONLINES.LIST.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],\n    validate(idProductionLine) {\n    },\n    run(idProductionLine) {\n        const responseMessage = new ResponseMessage();\n        try{\n            let workstationsIncluded=[];\n            const productionline= ProductionLineRepository.findOne({'_id':idProductionLine});\n\n            if(productionline){\n                //db.getCollection('workstations').find({'_id':{$in:['gMdEx5QjaGsxwekwY', 'P2CB6iverfv7E8eGp']}})\n                workstationsIncluded= productionline.workstations;\n               //workstationsIncluded= WorkstationRepository.find({'_id': {$in: productionline.workstations }  }).fetch();\n            }\n           \n            // El tercer parametro equivaldra al objeto data en el response\n        \n            responseMessage.create('Estaciones de trabajo incluidas a la linea de produccion','Estaciones incluidas en la linea de prod',workstationsIncluded);\n        }catch(ex){\n            console.log('productionline.workstations.included: ', ex);\n            throw new Meteor.Error('500','OcurriÃ³ un error al obtener la lista de estaciones de trabajo incluidas a una linea de produccion');\n        }\n\n        return responseMessage;\n    }\n\n});","\nimport {ProductionLineRepository} from \"./ProductionLine\";\n\nProductionLineRepository.rawCollection().createIndex({'name':1},{unique: true});\n\n","import {ProductionLineRepository} from \"./ProductionLine\";\nimport { PermissionMiddleware } from '../../middlewares/PermissionMiddleware';\nimport Permissions from '../../startup/server/Permissions';\n\nconst productionLinesPublication=new PublishEndpoint('productionlines.list',function(param1){\n        //return ProductionLineRepository.find({},{ _id:1,name:1,description:1,\n        return ProductionLineRepository.find({},{sort:{createdAt: -1}\n        });\n});\n\nproductionLinesPublication.use(new PermissionMiddleware(Permissions.PRODUCTIONLINES.LIST.VALUE));","\nimport {Meteor} from 'meteor/meteor';\nimport {ProductionLineRepository} from \"./ProductionLine\";\n\nexport default {\n\nvalidateProductionLineName(newProductionLine,idProductionLine){\n\n    const existsProductionLineName= ProductionLineRepository.find({name:newProductionLine}).fetch();\n        // recorrer la lista y comparar que uno diferente de mi tenga el mismo nombre\n        existsProductionLineName.filter(\n            productionline=>{\n                if (productionline.name==newProductionLine && productionline._id!==idProductionLine){\n                    throw new Meteor.Error('403', 'El nombre de la nueva linea de produccion  ya esta siendo utilizado');\n                }\n            }\n        );\n    }\n}","import { Mongo } from 'meteor/mongo';\n\nexport const Product = new Mongo.Collection('products');","import {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport {Product} from \"./Product\";\nimport ProductServ from \"./ProductServ\";\nimport {check, Match} from \"meteor/check\";\n\nnew ValidatedMethod({\n    name:'product.save',\n     mixins:[MethodHooks],\n     permissions: [Permissions.PRODUCTS.CREATE.VALUE,Permissions.PRODUCTS.UPDATE.VALUE],  \n     beforeHooks: [AuthGuard.checkPermission],\n    validate(product){\n        try {\n            console.info('product ', product)\n            check(product,{\n                _id: Match.OneOf(String, null),\n                name: String,\n                name_full: String,\n                unit: {\n                    _id: String,\n                    name: String\n                },\n                stock: String\n                ,\n                provider: {\n                    _id: String,\n                    name: String\n                },\n                location: String,\n                sku: String,\n                warehouse: {\n                    _id: String,\n                    name: String,\n                    name_full: String,\n                    location: String\n                },\n                production_line: {\n                    _id: String,\n                    description: String,\n                    name: String,\n                    workstations: [\n                        {\n                            _id: String,\n                            name: String,\n                            name_full: String,\n                            location: String,\n                            productionline: {\n                                description : String,\n                                name : String,\n                                _id : String\n                            }\n                        }\n                    ]\n                }\n                ,\n                bom:[\n                        {\n                            _id: Match.OneOf(String, null),\n                            name: Match.OneOf(String, null),\n                            quantity: Match.OneOf(String, null)\n                            \n                        }\n                    ],\n                isAvailable: Boolean\n            });\n\n        }catch ( exception){\n            console.error('product.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es valida');\n        }\n        // Validar que no haya producto con el mismo nombre\n        ProductServ.validateProductName(product.name,product._id);\n    },\n    run(product){\n        const responseMessage = new ResponseMessage(); \n        try {\n            if(product._id !== null){\n                // ToDO\n                // agregar registro en kardex si se ha cambiado el valor de stock\n                Product.update(product._id,{\n                    $set: {\n                    name: product.name,\n                    name_full: product.name_full,\n                    unit: product.unit,\n                    stock: product.stock,\n                    location: product.location,\n                    sku: product.sku,\n                    warehouse: product.warehouse,\n                    production_line: product.production_line,\n                    provider: product.provider,\n                    bom:    product.bomList,\n                    isAvailable: product.isAvailable\n                    }\n                });\n                responseMessage.create('Se actualizÃ³ la empresa exitosamente');\n            }else{\n                Product.insert({\n                    name: product.name,\n                    name_full: product.name_full,\n                    unit: product.unit,\n                    stock: product.stock,\n                    location: product.location,\n                    sku: product.sku,\n                    warehouse: product.warehouse,\n                    production_line: product.production_line,\n                    provider: product.provider,\n                    bom:    product.bomList,\n                    isAvailable: product.isAvailable\n                });\n                responseMessage.create('Se insertÃ³ el producto exitosamente');\n            }\n        }catch ( exception){\n            console.error('product.save', exception);\n            throw new Meteor.Error('500', 'Ha ocurrido un error al guardar el producto');\n        }\n        return responseMessage;\n    }\n });\n\nnew ValidatedMethod({\n    name: 'product.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PRODUCTS.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({ idProduct }){\n        try {\n            check(idProduct, String);\n        }catch (exception) {\n            console.error('product.delete', exception);\n            throw new Meteor.Error('403', 'Ocurrio un error al eliminar el producto');\n        }\n        // validar que no sea posible eliminar un producto si hay un almacen utilizandolo.\n        // ToDo\n        const isUseredByWarehouse = 0;\n        //CompanyServ.getUsersBycompany(idCompany);\n\n        if (isUseredByWarehouse.length > 0){\n            throw new Meteor.Error('403','No es posible elimiar el producto',\n                'Hay al menos un almacen utilizando el producto');\n        }\n    },\n    run({ idProduct }){\n        const responseMessage = new ResponseMessage();\n        try {\n            Product.remove(idProduct);\n                responseMessage.create('Producto eliminado exitosamente');\n        }catch (exception) {\n            console.error('product.delete', exception);\n            throw new Meteor.Error('500', 'Ocurrio un error al eliminar el producto');\n        }\n\n        return responseMessage;\n    }\n});\n","import { Product } from './Product';\nimport { PermissionMiddleware } from '../../middlewares/PermissionMiddleware';\nimport Permissions from '../../startup/server/Permissions';\n\nconst productPublication=new PublishEndpoint('product.list',function(param1){\n        return Product.find({},{\n                isAvailable:1,\n                  name:1,\n                  name_full:1,\n                  unit:1,\n                  stock:1,\n                  location:1,\n                  sku:1,\n                  warehouse:1,\n                  production_line:1\n              });\n});\n\nproductPublication.use(new PermissionMiddleware(Permissions.PRODUCTS.LIST.VALUE));","import {Product} from \"./Product\";\n\n//Product.rawCollection().createIndex({'name':1},{unique: true});\n","\nimport {Meteor} from \"meteor/meteor\";\nimport {Product} from \"./Product\";\n\nexport default {\n    \n    validateProductName(newProductName,idProduct){\n        const existsProduct= Product.findOne({name:newProductName});\n        if(idProduct !== null){  // actualizacion de producto\n            const oldProduct= Product.findOne(idProduct);\n            if(oldProduct.name !== newProductName && existsProduct){\n                throw new Meteor.Error('403', 'El nuevo nombre de producto ya esta siendo usado');\n            }\n        }else if(existsProduct){ // es producto nuevo pero el nombre  ya existe.\n                throw new Meteor.Error('403', 'El nuevo nombre del producto  ya esta siendo utilizado');\n\n        }\n    }\n}","import {Mongo} from 'meteor/mongo'\n\nexport const Profile = new Mongo.Collection('profiles');\n","import {check, Match} from \"meteor/check\";\nimport {Profile} from \"./Profile\";\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport ProfileServ from \"./ProfilesServ\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\n\n\nnew ValidatedMethod({\n    name: 'profile.save',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PROFILES.CREATE.VALUE,Permissions.PROFILES.UPDATE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate(profile) {\n        try {\n            // Valida que la estructura del objeto user este conforme a la definicion.\n            check(profile, {\n                _id: Match.OneOf(String, null),\n                name: String,\n                description: String,\n                permissions: [String]\n            });\n        } catch (exception) {\n            console.error('profile.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es vÃ¡lida.');\n        }\n        ProfileServ.validateProfileName(profile.name,profile._id);\n    },\n    run(profile) {\n        console.log('profile.save');\n        const responseMessage= new ResponseMessage();\n        if(profile._id !==null){\n            try{\n                const oldProfile= Profile.findOne(profile._id);\n                const users = ProfileServ.getUsersByprofile(profile._id);\n                Profile.update(profile._id,{\n                    $set:{\n                        name: profile.name,\n                        description: profile.description,\n                        permissions: profile.permissions\n                    }\n                });\n                // Aqui debemos actualizar a los usuarios con el perfil anterior por el nuevo\n                if(oldProfile.name !== profile.name){\n                  Meteor.users.update({'profile.profile':oldProfile.name},{\n                          $set: {\n                                  'profile.profile': profile.name\n                          }\n                      },{multi: true})\n                }\n                // Actualizamos los permisos para el nuevo rol a todos los usuarios en la tabla de relacion\n                // role-assignment\n                ProfileServ.updateProfileUsers(users,profile);\n                console.log('Se ha actualizado el perfil');\n                responseMessage.create('Se ha actualizado el perfil');\n            }catch (exception) {\n                console.error('profile.save', exception);\n                throw new Meteor.Error('500', 'OcurriÃ³ un error al actualizar el perfil');\n            }\n        }else{\n            console.log('perfil: ',profile);\n            try{\n                Profile.insert({\n                    name: profile.name,\n                    description: profile.description,\n                    permissions: profile.permissions\n                });\n                console.log('Se ha guardado el perfil');\n                responseMessage.create('Se ha guardado el perfil');\n            }catch (exception) {\n                console.error('profile.save', exception);\n                throw new Meteor.Error('500', 'OcurriÃ³ un error al guardar el perfil');\n            }\n        }\n\n\n        return responseMessage;\n    }\n});\n\nnew ValidatedMethod({\n    name: 'profile.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PROFILES.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({ idProfile }){\n        try {\n            check(idProfile, String);\n        }catch (exception) {\n            console.error('profile.delete', exception);\n            throw new Meteor.Error('403', 'Ocurrio un error al eliminar el perfil');\n        }\n        // validar que no sea posible eliminar un perfil si hay un usuario utilizandolo.\n        const userWithProfile = ProfileServ.getUsersByprofile(idProfile);\n        console.log('idProfile', idProfile);\n        console.log('userWithProfile', userWithProfile)\n        if (userWithProfile.length > 0){\n            throw new Meteor.Error('403','No es posible elimiar el perfil',\n                'Hay al menos un usuario utilizando el perfil');\n        }\n    },\n    run({ idProfile }){\n        const responseMessage = new ResponseMessage();\n        try {\n                Profile.remove(idProfile);\n                responseMessage.create('Perfil eliminado exitosamente');\n        }catch (exception) {\n            console.error('profile.delete', exception);\n            throw new Meteor.Error('500', 'Ocurrio un error al eliminar el perfil');\n        }\n\n\n        return responseMessage;\n    }\n});","import Permissions, {permissionsArray} from '../../startup/server/Permissions';\nimport {Profile} from \"./Profile\";\n\nProfile.rawCollection().createIndex({'name':1},{unique: true});\n\n\nexport const StaticProfiles={\n    admin: {\n        name: 'admin',\n        description: 'Administrador',\n        permissions: permissionsArray.map(p=>p.VALUE)\n    }\n};\n\nif(Meteor.isDevelopment){\n    if(Meteor.settings.private && Meteor.settings.private.REFRESH_STATIC_PROFILES){\n        console.log('Updating static profiles');\n        Object.keys(StaticProfiles).forEach(staticprofileName => {\n            Profile.upsert({name:StaticProfiles[staticprofileName].name},{\n               $set:{\n                   description:StaticProfiles[staticprofileName].description,\n                   permissions:StaticProfiles[staticprofileName].permissions\n               }\n            });\n            Meteor.users.find({'profile.profile':StaticProfiles[staticprofileName].name}).fetch().forEach(user => {\n\n               // Meteor.roleAssignments.remove({'user._id':user._id});\n                //RoleAssignment.remove({'user._id':user._id});\n               if(StaticProfiles[staticprofileName].permissions.length>0){\n                   Roles.setUserRoles(user._id,StaticProfiles[staticprofileName].permissions,StaticProfiles[staticprofileName].name);\n               }\n            });\n        });\n    }\n}","import { Profile } from './Profile';\nimport ProfilesServ from \"./ProfilesServ\";\nimport {PermissionMiddleware} from \"../../middlewares/PermissionMiddleware\";\nimport Permissions from \"../../startup/server/Permissions\";\n\nconst notStaticProfilePublication=new PublishEndpoint('notStaticProfile.list', function(param1) {\n         return Profile.find({name: { $nin:ProfilesServ.getStaticprofilesName()}});\n    });\nconst profilePublication=new PublishEndpoint('profile.listAll', function(param1) {\n    return Profile.find();\n});\n\nnotStaticProfilePublication.use(new PermissionMiddleware(Permissions.PROFILES.LIST.VALUE));\nprofilePublication.use(new PermissionMiddleware(Permissions.PROFILES.LIST.VALUE));\n","import {Profile} from './Profile';\nimport {Meteor} from 'meteor/meteor'\nimport {StaticProfiles} from \"./ProfileSeeder\";\n\nexport default {\n\n    getUsersByprofile(idPrtofile){\n            const profile = Profile.findOne(idPrtofile);\n            return Meteor.users.find({'profile.profile':profile.name}).fetch();\n        },\n    setUsersRoles(idUser, profileName){\n        const permissions= Profile.findOne({'name':profileName}).permissions;\n         Meteor.roleAssignment.remove({'user._id': idUser});\n         Roles.setUserRoles(idUser,permissions,profileName);\n        },\n    updateProfileUsers(users,profile){\n      users.forEach(user => {\n                this.setUsersRoles(user._id,profile.name);\n           });\n    },validateProfileName(newProfileName,idProfile){\n        const query = { name: newProfileName };\n        const existsProfileName= Profile.findOne(query);\n        if (idProfile){ // actualizacion de usuario//\n            const oldProfile= Profile.findOne(idProfile);\n            if(oldProfile.name !== newProfileName && existsProfileName){\n                throw new Meteor.Error('403', 'El nombre del Perfil  ya esta siendo utilizado');\n            }\n\n        }else if(existsProfileName){ // El nombre de NUEVO profile ya existe\n            throw new Meteor.Error('403', 'El nombre del Perfil  ya esta siendo utilizado');\n        }\n    },\n    getStaticprofilesName(){\n\n        return Object.keys(StaticProfiles).map(staticprofileName => {\n            return StaticProfiles[staticprofileName].name;\n        });\n    }\n\n\n}","import { Mongo } from 'meteor/mongo';\n\nexport const Provider = new Mongo.Collection('providers');\n","import {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport {Provider} from \"./Provider\";\nimport ProviderServ from \"./ProviderServ\";\nimport {check, Match} from \"meteor/check\";\n\nnew ValidatedMethod({\n    name:'provider.save',\n     mixins:[MethodHooks],\n     permissions: [Permissions.PROVIDERS.CREATE.VALUE,Permissions.PROVIDERS.UPDATE.VALUE],  \n     beforeHooks: [AuthGuard.checkPermission],\n    validate(provider){\n        try {\n            \n            check(provider,{\n                _id: Match.OneOf(String, null),\n                name: String,\n                name_full: String,\n                providerBussinessId: String,\n                address: String,\n                phones: String,\n                web: String,\n                email: String,\n                isAvailable: Boolean\n            });\n\n        }catch ( exception){\n            console.error('provider.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es valida');\n        }\n        // Validar que no haya proveedores con el mismo nombre y BussinesID\n        ProviderServ.validateProviderBussinessId(provider.providerBussinessId,provider._id);\n        ProviderServ.validateProviderName(provider.name,provider._id);\n    },\n    run(provider){\n        const responseMessage = new ResponseMessage(); \n        try {\n            if(provider._id !== null){\n                Provider.update(provider._id,{\n                    $set: {\n                    name: provider.name,\n                    name_full: provider.name_full,\n                    providerBussinessId: provider.providerBussinessId,\n                    address: provider.address,\n                    phones: provider.phones,\n                    web: provider.web,\n                    email: provider.email,\n                    isAvailable: provider.isAvailable\n                    }\n                });\n                responseMessage.create('Se actualizÃ³ el proveedor exitosamente');\n            }else{\n                Provider.insert({\n                    name: provider.name,\n                    name_full: provider.name_full,\n                    providerBussinessId: provider.providerBussinessId,\n                    address: provider.address,\n                    phones: provider.phones,\n                    web: provider.web,\n                    email: provider.email,\n                    isAvailable: provider.isAvailable\n                });\n                responseMessage.create('Se insertÃ³ el proveedor exitosamente');\n            }\n        }catch ( exception){\n            console.error('company.save', exception);\n            throw new Meteor.Error('500', 'Ha ocurrido un error al guardar el proveedor');\n        }\n        return responseMessage;\n    }\n });\n\nnew ValidatedMethod({\n    name: 'provider.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.PROVIDERS.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({ idProvider }){\n        try {\n            check(idProvider, String);\n        }catch (exception) {\n            console.error('provider.delete', exception);\n            throw new Meteor.Error('403', 'Ocurrio un error al eliminar al proveedor');\n        }\n        // validar que no sea posible eliminar un proveedor si hay un producto utilizandolo.\n        // ToDo \n        const toUseInToProduct = 0;\n        //CompanyServ.getUsersBycompany(idCompany);\n\n        if (toUseInToProduct.length > 0){\n            throw new Meteor.Error('403','No es posible elimiar al proveedor',\n                'Hay al menos un producto utilizando al proveedor');\n        }\n    },\n    run({ idProvider}){\n        const responseMessage = new ResponseMessage();\n        try {\n            Provider.remove(idProvider);\n                responseMessage.create('Proveedor eliminado exitosamente');\n        }catch (exception) {\n            console.error('provider.delete', exception);\n            throw new Meteor.Error('500', 'Ocurrio un error al eliminar al proveedor');\n        }\n\n        return responseMessage;\n    }\n});\n","import { Provider } from './Provider';\nimport { PermissionMiddleware } from '../../middlewares/PermissionMiddleware';\nimport Permissions from '../../startup/server/Permissions';\n\nconst providerPublication=new PublishEndpoint('provider.list',function(param1){\n        return Provider.find({},{});\n});\n\nproviderPublication.use(new PermissionMiddleware(Permissions.PROVIDERS.LIST.VALUE));","\nimport { Provider } from './Provider';\n\n\nProvider.rawCollection().createIndex(\n    {\"providerBussinessId\" : 1,},{unique: true}\n    );\n","\nimport {Meteor} from \"meteor/meteor\";\nimport { Provider } from \"./Provider\";\n\nexport default {\n\n    validateProviderBussinessId(newProviderBussinesId,idProvider){\n\n        const existsProvider= Provider.findOne({providerBussinessId:newProviderBussinesId});\n        if(idProvider !== null){  // actualizacion de Proveedor\n            const oldProvider= Provider.findOne(idProvider);\n            if(oldProvider.providerBussinessId !== newProviderBussinesId && existsProvider){\n                throw new Meteor.Error('403', 'El nuevo RFC del proveedor ya esta siendo usado');\n            }\n        }else if(existsProvider){ // es compaÃ±ia nuevo pero el ProviderBussinesId  ya existe.\n                throw new Meteor.Error('403', 'El nuevo RFC del proveedor ya esta siendo utilizado');\n\n        }\n\n    },\n    validateProviderName(newProviderName,idProvider){\n        const existsProvider= Provider.findOne({name:newProviderName});\n        if(idProvider !== null){  // actualizacion de proveedor\n            const oldProvider= Provider.findOne(idProvider);\n            if(oldProvider.name !== newProviderName && existsProvider){\n                throw new Meteor.Error('403', 'El nuevo nombre del proveedor ya esta siendo usado');\n            }\n        }else if(existsProvider){ // es proveedor nuevo pero el name  ya existe.\n                throw new Meteor.Error('403', 'El nuevo nombre del proveedor ya esta siendo utilizado');\n\n        }\n    }\n}","import Permissions from \"../../startup/server/Permissions\"\nexport default [\n            {\n            title:'Inicio',\n            permission:null,\n            routeName:'home'\n            },\n            {\n                title:'Usuarios',\n                permission:Permissions.USERS.LIST.VALUE,\n                routeName:'home.users'\n            },\n            {\n                title:'Perfiles',\n                permission:Permissions.PROFILES.LIST.VALUE,\n                routeName:'home.profiles'\n            },\n            {\n                title:'Empresas',\n                permission: Permissions.COMPANIES.LIST.VALUE,\n                routeName:'home.companies'\n            },\n            {\n                title:'Chat',\n                permission: Permissions.CHAT.LIST.VALUE,\n                routeName:'home.chat'\n            },\n            {\n                title:'Lineas Produccion',\n                permission: Permissions.PRODUCTIONLINES.LIST.VALUE,\n                routeName:'home.productionlines'\n            },\n            {\n                title:'Ordenes Produccion',\n                permission: Permissions.PRODUCTIONORDERS.LIST.VALUE,\n                routeName:'home.productionorders'\n            },\n            {\n                title:'Productos',\n                permission: Permissions.PRODUCTS.LIST.VALUE,\n                routeName:'home.products'\n            },\n            {\n                title:'Est Suministro',\n                permission: Permissions.PROVIDERSTATIONS.LIST.VALUE,\n                routeName:'home.providerstation'\n            },\n            {\n                title:'Almacenes',\n                permission: Permissions.WAREHOUSES.LIST.VALUE,\n                routeName:'home.warehouses'\n            },\n            {\n                title:'Proveedores',\n                permission: Permissions.PROVIDERS.LIST.VALUE,\n                routeName:'home.providers'\n            },\n            {\n                title:'Estaciones Trabajo',\n                permission: Permissions.WORKSTATIONS.LIST.VALUE,\n                routeName:'home.workstations'\n            }    \n    ]","import SystemOptions from \"./SystemOptions\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\"\n\nnew ValidatedMethod({\n   name:'user.getSystemOptions',\n    mixins:[MethodHooks],\n    beforeHooks: [AuthGuard.isUserLogged],\n   validate:null,\n   run(){\n       const responseMessage = new ResponseMessage();\n       const userLogged= Meteor.user();\n       const userRoles=Roles.getRolesForUser(userLogged._id,userLogged.profile.profile);\n       //console.log('userRoles',userRoles);\n       const optionOfUser= SystemOptions.reduce((accumulator,systemOption)=>{\n           if(!systemOption.permission || !!userRoles.find(role=> role === systemOption.permission)){\n               accumulator.push(systemOption);\n           }\n           return accumulator;\n       },[]);\n       //console.log(optionOfUser);\n       responseMessage.create('Opciones del sistema para el usuario',null,optionOfUser);\n       return responseMessage;\n   }\n});","import {User } from 'meteor/socialize:user-model';\nconst { default: SimpleSchema } = require(\"simpl-schema\");\n\nMeteor.users.rawCollection().createIndex({'profile.profile':1});\nconst UserProfileSchema= new SimpleSchema({\n    profile: {\n        type: Object,\n        optional: false,\n        blackbox: true\n    }\n});\nUser.attachSchema(UserProfileSchema);","import { Meteor } from 'meteor/meteor';\nimport { User } from 'meteor/socialize:user-model';\nimport { UserPresence } from 'meteor/socialize:user-presence';\nimport SimpleSchema from 'simpl-schema';\n\n// Schema for the fields where we will store the status data\nconst StatusSchema = new SimpleSchema({\n   status: Object,\n   'status.online':{type:Boolean},\n   'status.idle':{type:Boolean,optional:true},\n   'status.lastLogin':{type:Object, optional: true, blackbox: true}\n});\n\n// Add the schema to the existing schema currently attached to the User model\nUser.attachSchema(StatusSchema);\n\n// If `sessionIds` is undefined this signifies we need a fresh start.\n// When a full cleanup is necessary we will unset the status field to show all users as offline\nUserPresence.onCleanup(function onCleanup(sessionIds) {\n    if (!sessionIds) {\n        Meteor.users.update({},{$set: {'status.online':false}} ,{ $unset: { status: true } }, { multi: true });\n    }\n});\n\n// When a user comes online we set their status to online and set the lastOnline field to the current time\nUserPresence.onUserOnline(function onUserOnline(userId,connection) {\n    Meteor.users.update(userId, { \n        $set: { \n            'status.online': true, \n            'status.idle': false ,\n            'status.lastLogin': {\n                date: new Date(),\n                ipAddr: connection.clientAddress,\n                userAgent: connection.httpHeaders['user-agent']\n            }\n        }\n        \n        });\n});\n\n// When a user goes idle we'll set their status to indicate this\nUserPresence.onUserIdle(function onUserIdle(userId) {\n    Meteor.users.update(userId, { $set: { 'status.idle': true } });\n});\n\n// When a user goes offline we'll unset their status field to indicate offline status\nUserPresence.onUserOffline(function onUserOffline(userId) {\n    Meteor.users.update(userId, { $set:{'status.online':false}, $unset: { 'status.idle':true } });\n});","import {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {check} from 'meteor/check';\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport UsersServ from \"./UsersServ\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport {Meteor} from 'meteor/meteor'\nimport './UserPresenceConfig'\n\n// se inserta usuario mediante un listener para agregar el Schema\nAccounts.onCreateUser( (options,user) => {\n    const customizedUser = Object.assign({\n        status: {\n            online: false\n        }\n    }, user);\n    if(options.profile){\n        customizedUser.profile = options.profile;\n    }\n    return customizedUser;\n    \n});\n\n// Aqui removemos los rgistros de tokens del objeto user en la BD\nAccounts.validateLoginAttempt( loginAttempt=>{\n   //console.log('loginAttempt ' , loginAttempt);\n   // console.log('allowed' , loginAttempt.allowed);\n   // console.log('correo verificado' , loginAttempt.user.emails[0].verified);\n    if(loginAttempt.allowed){\n        if(!loginAttempt.user.emails[0].verified){\n            throw new Meteor.Error('403', 'El correo del usuario no ha sido verificado aÃºn');\n        }\n        const loginTokensOfuser=loginAttempt.user.services.resume?.loginTokens || [];\n        //console.log('loginTokensOfuser ', loginTokensOfuser)\n        if(loginTokensOfuser.length > 1){\n            Meteor.users.update(loginAttempt.user._id,{\n                $set:{\n                    'services.resume.loginTokens': [loginTokensOfuser.pop()]\n                }\n            });\n        }\n        return true;\n    }\n\n});\n\n\nnew ValidatedMethod({\n    name: 'user.save',\n    mixins: [MethodHooks],\n    permissions: [Permissions.USERS.CREATE.VALUE,Permissions.USERS.UPDATE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({user}) {\n        try {\n            // Valida que la estructura del objeto user este conforme a la definicion.\n            console.log(\"Usuario \",user);\n            check(user, {\n                _id: Match.OneOf(String, null),\n                username: String,\n                emails: [{address: String, verified: Boolean}],\n                profile: {\n                    profile: String,\n                    name: String,\n                    path: Match.OneOf(String, null)\n                }\n                //,\n                //password:String\n            });\n        } catch (exception) {\n            console.error('user.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es vÃ¡lida.');\n        }\n        // Validar que no haya usuarios con el mismo correo y nombre de usuario en la BD.\n        UsersServ.validateEmail(user.emails[0].address,user._id);\n        UsersServ.validateUserName(user.username,user._id);\n\n    },\n    async run({user,photoFileUser}) {\n     //   async run(user) {\n        console.log('user.save');\n        console.log('Usuario logeado ', this.userId);\n        const responseMessage= new ResponseMessage();\n        if(user._id !==null){\n            console.log('Actualizando usuario a la BD');\n            try {\n                await UsersServ.updateuser(user,photoFileUser);\n            }catch(exception){\n                console.error('user.save',exception);\n                throw new Meteor.Error('500','OcurriÃ³ un error al actualizar los datos del usuario');\n            }\n            console.log('Se actualizaron los datos del usuario exitosamente');\n            responseMessage.create('Se actualizaron los datos del usuario exitosamente');\n        }else{\n            console.log('Agregando usuario a la BD');\n            try{\n                await UsersServ.createUser(user,photoFileUser);\n               //await UsersServ.createUser(user,null);\n                console.log('Se ha guardado el usuario');\n                responseMessage.create('Se ha guardado el usuario');\n            }catch (exception) {\n                console.error('user.save', exception);\n                throw new Meteor.Error('500', 'OcurriÃ³ un error al guardar el usuario');\n            }\n        }\n\n\n        return responseMessage;\n    }\n});\n\n\nnew ValidatedMethod({\n    name:'user.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.USERS.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],\n    validate({idUser}){\n        try{\n            check('idUser',String);\n        }catch (exception) {\n            console.error('user.remove', exception);\n            throw new Meteor.Error('403','La informacion proporcionada no es correcta');\n        }\n\n    },\n    async run({idUser}){\n        const responseMessage = new ResponseMessage;\n\n        try{\n                console.log('Eliminando usuario a la BD');\n               await UsersServ.deleteUser(idUser);\n\n        }catch(exception){\n            console.error('user.remove','OcurriÃ³ un error al eliminar al usaurio');\n            throw new Meteor.Error('500', 'ocurriÃ³ un error al eliminar al usaurio');\n        }\n\n        responseMessage.create('Usuario eliminado exitosamente');\n        return responseMessage;\n    }\n});\n\nnew ValidatedMethod({\n    name: 'user.updatePersonalData',\n    mixins: [MethodHooks],\n    beforeHooks: [AuthGuard.isUserLogged],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({user}) {\n        try {\n            // Valida que la estructura del objeto user este conforme a la definicion.\n            check(user, {\n                _id: Match.OneOf(String, null),\n                username: String,\n                emails: [{address: String, verified: Boolean}],\n                profile: {\n                    profile: String,\n                    name: String,\n                    path: Match.OneOf(String, null)\n                }\n            });\n        } catch (exception) {\n            console.error('user.updatePersonalData', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es vÃ¡lida.');\n        }\n        // Validar que no haya usuarios con el mismo correo y nombre de usuario en la BD.\n        UsersServ.validateEmail(user.emails[0].address,user._id);\n        UsersServ.validateUserName(user.username,user._id);\n\n    },\n    async run({user,photoFileUser}) {\n        console.log('user.updatePersonalData');\n        //console.log('Usuario logeado ', this.userId);\n        const responseMessage= new ResponseMessage();\n        if(user._id !==null){\n            try {\n                await UsersServ.updateuser(user,photoFileUser);\n            }catch(exception){\n                console.error('user.updatePersonalData',exception);\n                throw new Meteor.Error('500','OcurriÃ³ un error al actualizar los datos del usuario');\n            }\n            console.log('Se actualizaron los datos del usuario exitosamente');\n            responseMessage.create('Se actualizaron los datos del usuario exitosamente');\n        }\n\n        return responseMessage;\n    }\n});","/* Forma de publicar\nMeteor.publish('user.list',function(){\n        return Meteor.users.find();\n});\n\n */\n// no lo reconoce quitar advertencia\nimport {PermissionMiddleware} from \"../../middlewares/PermissionMiddleware\"\nimport Permissions from \"../../startup/server/Permissions\"\nconst userPublication=new PublishEndpoint('user.list',function(param1){\n        return Meteor.users.find({},{\n                sort:{createdAt: -1}\n        });\n});\n\nuserPublication.use(new PermissionMiddleware(Permissions.USERS.LIST.VALUE));\n","import ProfilesServ from \"../Profiles/ProfilesServ\";\nimport FileOperations from \"../../startup/server/utilities/FileOperations\";\nimport {Meteor} from \"meteor/meteor\";\n\nconst PATH_USERS_FILENAME = 'users/';\nexport default {\n\n    validateEmail(newEmail,idUser){\n\n        const existsEmail= Accounts.findUserByEmail(newEmail);\n        if(idUser){  // actualizacion de usuario\n            const oldUser= Meteor.users.findOne(idUser);\n            if(oldUser.emails[0].address!== newEmail && existsEmail){\n                throw new Meteor.Error('403', 'El nuevo correo electronico ya esta siendo usado');\n            }\n        }else if(existsEmail){ // es usuario nuevo pero el correo  ya existe.\n                throw new Meteor.Error('403', 'El nuevo correo ya esta siendo utilizado');\n\n        }\n\n    },\n    validateUserName(newUserName,idUser){\n        const existsUserName= Accounts.findUserByUsername(newUserName);\n        if (idUser){ // actualizacion de usuario//\n            const oldUser= Meteor.users.findOne(idUser);\n            if(oldUser.username!==newUserName && existsUserName){\n                throw new Meteor.Error('403', 'El nombre de usuario  ya esta siendo utilizado');\n            }\n\n        }else if(existsUserName){ // El nombre de NUEVO usuario ya existe\n            throw new Meteor.Error('403', 'El nombre de usuario  ya esta siendo utilizado');\n        }\n    },\n    async createUser(user,photoFileUser){\n        const idUser= Accounts.createUser({\n            username: user.username,\n            email: user.emails[0].address,\n            profile: user.profile\n            //,  AL CREAR USUARIO no se fija el password porque se implementara un envio de una URL para que el usuario lo fije\n            //password: user.password\n        });\n        if(idUser){\n            ProfilesServ.setUsersRoles(idUser,user.profile.profile);\n            Accounts.sendEnrollmentEmail(idUser,user.emails[0].address);\n        }\n        let avatarSrc= null;\n\n        if(photoFileUser){\n            const response= await FileOperations.saveFileFromBase64ToGoogleStorage(photoFileUser,'avatar',\n                PATH_USERS_FILENAME+idUser);\n            if(!response.data.success){\n                throw new Meteor.Error('403','Error al subir la foto');\n            }else{\n                avatarSrc= response.data.fileUrl;\n            }\n        }\n        Meteor.users.update(idUser,{\n            $set: {\n                'profile.path': avatarSrc\n            }\n        });\n\n\n    },\n    async updateuser(user,photoFileUser){\n        const currentUser=Meteor.users.findOne(user._id);\n\n        if(currentUser!==undefined){\n            if(currentUser.emails[0].address!==user.emails[0].address ){\n                Accounts.removeEmail(currentUser._id, currentUser.emails[0].address);\n                Accounts.addEmail(currentUser._id,user.emails[0].address);\n                Accounts.sendVerificationEmail(user._id,user.emails[0].address);\n            }\n            if(currentUser.username!==user.username ){\n                Accounts.setUsername(currentUser._id,user.username);\n            }\n            Meteor.users.update(user._id,{\n                $set:{\n                    profile:{\n                        profile: user.profile.profile,\n                        name: user.profile.name,\n                        path: currentUser.profile.path\n                    }\n                }\n            });\n            ProfilesServ.setUsersRoles(user._id,user.profile.profile);\n            if(photoFileUser){\n                if(currentUser.profile.path){\n                    await FileOperations.deleteFileFromGoogleStoreIfExists(currentUser.profile.path\n                        .substring(currentUser.profile.path.lastIndexOf(PATH_USERS_FILENAME)));\n                }\n                const response= await FileOperations.saveFileFromBase64ToGoogleStorage(photoFileUser,'avatar',\n                    PATH_USERS_FILENAME+user._id);\n                if(!response.data.success){\n                    throw new Meteor.Error('403','Error al subir la foto');\n                }else{\n                    Meteor.users.update(user._id,{\n                        $set: {\n                            'profile.path': response.data.fileUrl\n                        }\n                    });\n\n                }\n            }\n        }else{\n            throw new Meteor.Error('403', 'El usuario por actualizar no estÃ¡ en la BD');\n        }\n\n    },\n   async  deleteUser(idUser){\n        Meteor.users.remove(idUser);\n        Meteor.roleAssignment.remove({'user._id':idUser});\n        await FileOperations.deleteFilesOfFolderFromGoogleStorage(PATH_USERS_FILENAME+idUser);\n    }\n}","import { Mongo } from 'meteor/mongo';\n\nexport const WarehouseRepository = new Mongo.Collection('warehouses');\n","import {check, Match} from \"meteor/check\";\nimport {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport {WarehouseRepository} from './Warehouse'\nimport WarehouseServ from \"./WarehouseServ\";\n\nnew ValidatedMethod({\n    name:'warehouse.save',\n     mixins:[MethodHooks],\n     permissions: [Permissions.WAREHOUSES.CREATE.VALUE,Permissions.WAREHOUSES.UPDATE.VALUE],  \n     beforeHooks: [AuthGuard.checkPermission],\n    validate(warehouse){\n        try {\n            \n            check(warehouse,{\n                _id: Match.OneOf(String, null),\n                name: String,\n                name_full: String,\n                location: String\n            });\n\n        }catch ( exception){\n            console.error('warehouse.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es valida');\n        }\n        // Validar que no haya almacenes con el mismo nombre   \n        \n        WarehouseServ.validateWarehouseName(warehouse.name,warehouse._id);\n    },\n    run(warehouse){\n        const responseMessage = new ResponseMessage(); \n        try {\n            if(warehouse._id !== null){\n                \n                WarehouseRepository.update(warehouse._id,{\n                    $set: {\n                    name: warehouse.name,\n                    name_full: warehouse.name_full,\n                    location: warehouse.location\n                    }\n                });\n                \n\n                responseMessage.create('Se actualizÃ³ el almacen exitosamente');\n            }else{\n                WarehouseRepository.insert({\n                    name: warehouse.name,\n                    name_full: warehouse.name_full,\n                    location: warehouse.location\n                });\n\n                responseMessage.create('Se insertÃ³ el almacen exitosamente');\n            }\n        }catch ( exception){\n            console.error('warehouse.save', exception);\n            throw new Meteor.Error('500', 'Ha ocurrido un error al guardar el almacen');\n        }\n        return responseMessage;\n    }\n });\n\nnew ValidatedMethod({\n    name: 'warehouse.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.WAREHOUSES.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({ idWarehouse }){\n        try {\n            console.log('idWarehouse ', idWarehouse);\n            check(idWarehouse , String);\n        }catch (exception) {\n            console.error('warehouse.delete', exception);\n            throw new Meteor.Error('403', 'Ocurrio un error al eliminar el almacen');\n        }\n        // validar que no sea posible eliminar un almacen si hay un producto utilizandolo.\n        const warehouseWithProduct = WarehouseServ.validateWarehouseBusy(idWarehouse);\n        if (warehouseWithProduct > 0){\n            throw new Meteor.Error('403','No es posible elimiar el almacen',\n                'Hay al menos un producto utilizandolo');\n        }\n    },\n    run({ idWarehouse }){\n        const responseMessage = new ResponseMessage();\n        try {\n            WarehouseRepository.remove(idWarehouse);\n                responseMessage.create('Almacen eliminado exitosamente');\n        }catch (exception) {\n            console.error('warehouse.delete', exception);\n            throw new Meteor.Error('500', 'Ocurrio un error al eliminar el almacen');\n        }\n\n        return responseMessage;\n    }\n});\n","import { WarehouseRepository } from './Warehouse';\nimport { PermissionMiddleware } from '../../middlewares/PermissionMiddleware';\nimport Permissions from '../../startup/server/Permissions';\n\nconst warehousePublication=new PublishEndpoint('warehouse.list',function(param1){\n        return WarehouseRepository.find({},{});\n});\n\nwarehousePublication.use(new PermissionMiddleware(Permissions.WAREHOUSES.LIST.VALUE));","import Permissions, {permissionsArray} from '../../startup/server/Permissions';\nimport {WarehouseRepository} from \"./Warehouse\";\n\nWarehouseRepository.rawCollection().createIndex({'name':1},{unique: true});\n\n","import {Meteor} from \"meteor/meteor\";\nimport {WarehouseRepository} from './Warehouse'\n\n\nexport default {\n\n    validateWarehouseName(newWarehouseName,idWarehouse){\n        const existsWarehouseList= WarehouseRepository.find({name:newWarehouseName}).fetch();\n        // recorrer la lista y comparar que uno diferente de mi tenga el mismo nombre\n        existsWarehouseList.filter(\n            warehouse=>{\n                if (warehouse.name==newWarehouseName && warehouse._id!==idWarehouse){\n                    throw new Meteor.Error('403', 'El nombre del almacen ya esta siendo utilizado');\n                }\n            }\n        );\n    },\n    validateWarehouseBusy(idWarehouse){\n\n        // ToDo Buscar productos con almacen id \n        return 0;\n\n    }\n}","import { Mongo } from 'meteor/mongo';\nexport const WorkstationRepository = new Mongo.Collection('workstations');","import {check, Match} from \"meteor/check\";\nimport {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport {WorkstationRepository} from './WorkStation'\nimport WorkStationServ from \"./WorkStationServ\";\n\nnew ValidatedMethod({\n    name:'workstation.save',\n     mixins:[MethodHooks],\n     permissions: [Permissions.WORKSTATIONS.CREATE.VALUE,Permissions.WORKSTATIONS.UPDATE.VALUE],  \n     beforeHooks: [AuthGuard.checkPermission],\n    validate(workstation){\n        try {\n            console.info('workstation ' , workstation);\n            check(workstation,{\n                _id: Match.OneOf(String, null),\n                name: String,\n                name_full: String,\n                location: String,\n                productionline: {\n                    _id:Match.OneOf(String, null),\n                    name: Match.OneOf(String, null),\n                    description:Match.OneOf(String, null)\n                }\n            });\n\n        }catch ( exception){\n            console.error('workstation.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es valida');\n        }\n        // Validar que no haya estaciones de trabajo con el mismo nombre   \n        \n        WorkStationServ.validateWorkstationName(workstation.name,workstation._id);\n    },\n    run(workstation){\n        const responseMessage = new ResponseMessage(); \n        try {\n            if(workstation._id !== null){\n                WorkStationServ.validateWorkstationChangeProductionLine(workstation);\n                WorkstationRepository.update(workstation._id,{\n                    $set: {\n                    name: workstation.name,\n                    name_full: workstation.name_full,\n                    location: workstation.location,\n                    productionline: workstation.productionline\n                    }\n                });\n                \n\n                responseMessage.create('Se actualizÃ³ la estacion de trabajo exitosamente');\n            }else{\n                WorkstationRepository.insert({\n                    name: workstation.name,\n                    name_full: workstation.name_full,\n                    location: workstation.location,\n                    productionline: workstation.productionline\n                });\n\n                // ToDo actualizar la Linea de produccion\n\n                responseMessage.create('Se insertÃ³ la estacion de trabajo exitosamente');\n            }\n        }catch ( exception){\n            console.error('workstation.save', exception);\n            throw new Meteor.Error('500', 'Ha ocurrido un error al guardar la estacion de trabajo');\n        }\n        return responseMessage;\n    }\n });\n\nnew ValidatedMethod({\n    name: 'workstation.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.WORKSTATIONS.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({ idWorkstation }){\n        try {\n            check(idWorkstation , String);\n        }catch (exception) {\n            console.error('workstation.delete', exception);\n            throw new Meteor.Error('403', 'Ocurrio un error al eliminar la estacion de trabajo');\n        }\n        // validar que no sea posible eliminar una estacion si hay una linea utilizandolo.\n        const workstationWithProductionLine = WorkStationServ.validateWorkstationBusy(idWorkstation);\n        if (workstationWithProductionLine > 0){\n            throw new Meteor.Error('403','No es posible elimiar la estacion de trabajo',\n                'Hay al menos una linea de produccion utilizandola');\n        }\n    },\n    run({ idWorkstation }){\n        const responseMessage = new ResponseMessage();\n        try {\n            WorkstationRepository.remove(idWorkstation);\n                responseMessage.create('Estacion de trabajo eliminada exitosamente');\n        }catch (exception) {\n            console.error('workstation.delete', exception);\n            throw new Meteor.Error('500', 'Ocurrio un error al eliminar la estacion de trabajo');\n        }\n\n        return responseMessage;\n    }\n});\n","import { WorkstationRepository } from './WorkStation';\nimport { PermissionMiddleware } from '../../middlewares/PermissionMiddleware';\nimport Permissions from '../../startup/server/Permissions';\n\nconst workstationPublication=new PublishEndpoint('workstation.list',function(param1){\n        return WorkstationRepository.find({},{\n                sort:{createdAt: -1}\n        });\n});\n\nworkstationPublication.use(new PermissionMiddleware(Permissions.WORKSTATIONS.LIST.VALUE));","import {Meteor} from \"meteor/meteor\";\nimport {WorkstationRepository} from './WorkStation'\nimport {ProductionLineRepository} from '../ProductionLines/ProductionLine'\n\nexport default {\n\n    validateWorkstationName(newWorkstationName,idWorkstation){\n        const existsWorkstationList= WorkstationRepository.find({name:newWorkstationName}).fetch();\n        // recorrer la lista y comparar que uno diferente de mi tenga el mismo nombre\n        existsWorkstationList.filter(\n            workstation=>{\n                if (workstation.name==newWorkstationName && workstation._id!==idWorkstation){\n                    throw new Meteor.Error('403', 'El nombre de la estacion de trabajo  ya esta siendo utilizado');\n                }\n            }\n        );\n    },\n    validateWorkstationBusy(idWorkstation){\n        const existsWorkstationNumber= ProductionLineRepository.find({'workstations._id':idWorkstation}).count();\n        return existsWorkstationNumber;\n    },\n    validateWorkstationChangeProductionLine(workstation){\n        // actualizar la Linea de produccion si es diferente de la actual\n                // Validar que la linea nueva es diferente de la vieja.\n                // Si es diferente hay que removerla de la linea de produccion vieja.\n                const oldWorkstation = WorkstationRepository.findOne(workstation._id);\n                \n                if(oldWorkstation){\n                    if(oldWorkstation.productionline._id !== workstation.productionline._id){\n                        const oldProductionLine = ProductionLineRepository.findOne(oldWorkstation.productionline._id);\n                        const oldProductionLineWorkstationsUpdated = oldProductionLine.workstations.filter(\n                            ws => ws._id  !== workstation._id\n                        );\n                        ProductionLineRepository.update(oldProductionLine._id,{\n                            $set: {\n                             workstations: oldProductionLineWorkstationsUpdated\n                            }\n                        });\n                    }\n\n                }\n\n    }\n}","const checkPermission=function(methodArgs,methodOptions){\n        const idUser= this.userId;\n        const permissions= methodOptions.permissions;\n        let hasPermission=false;\n        if(idUser!== null){\n            const profileName=Meteor.user().profile.profile;\n            hasPermission=Roles.userIsInRole(idUser,permissions,profileName)\n        }\n        if(!hasPermission){\n           throw new Meteor.Error('403', 'Acceso denegado.', 'No tienes permiso para ejecutar esta accion');\n        }\n        return methodArgs;\n};\n\nconst isUserLogged=function(methodArgs,methodOptions){\n  if(!this.userId){\n      throw new Meteor.Error('403','Acceso denegado.', 'No tienes permiso para ejecutar esta opcion');\n  }\n  return methodArgs;\n};\n\nexport default {checkPermission,isUserLogged};","export class PermissionMiddleware extends PublishMiddleware {\n\n        constructor(permissions){\n            super();\n            this._permissions = permissions;\n        }\n\n        // solo a este evento no le verificamos permisos para no sobre cargar el proceso\n        // ya que en una lista por cada elemento agregado es llamada esta funcion\n        added(publish,collection,id,fields){\n            if(publish.userId){\n                return super.added(...arguments);\n            }\n            return publish.ready();\n        }\n\n        changed(publish,collection,id,fields){\n            if (this.checkPermission(publish.userId)){\n              return super.changed(...arguments);\n            }\n            return publish.ready();\n\n        }\n\n        removed(publish,collection,id){\n            if (this.checkPermission(publish.userId)){\n                return super.removed(...arguments);\n            }\n            return publish.ready();\n\n        }\n\n        onReady(publish){\n            if (publish.userId){\n                return super.onReady(...arguments);\n            }\n            return publish.ready();\n\n        }\n        onStop(publish){\n            if (publish.userId){\n                return super.onStop(...arguments);\n            }\n            return publish.ready();\n\n        }\n\n        onError(publish,error){\n            if (publish.userId){\n                return super.onError(...arguments);\n            }\n            return publish.ready();\n\n        }\n\n\n        checkPermission(idUser){\n            const profileName=Roles.getScopesForUser(idUser)[0];\n            return Roles.userIsInRole(idUser, this._permissions, profileName);\n        }\n\n}","import \"/imports/startup/server\";\nimport \"/imports/startup/both\""]}