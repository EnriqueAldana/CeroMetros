{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/enrique/DiscoDeEnrique/2021/Proyectos/CeroMetros/imports/api/Warehouses/WarehouseCtl.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"imports/api/Warehouses/WarehouseCtl.js","filename":"/Users/enrique/DiscoDeEnrique/2021/Proyectos/CeroMetros/imports/api/Warehouses/WarehouseCtl.js","cloneInputAst":true,"passPerPreset":false,"envName":"development","cwd":"/Users/enrique/DiscoDeEnrique/2021/Proyectos/CeroMetros","root":"/Users/enrique/DiscoDeEnrique/2021/Proyectos/CeroMetros","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.12.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/enrique/DiscoDeEnrique/2021/Proyectos/CeroMetros/imports/api/Warehouses/WarehouseCtl.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/api/Warehouses/WarehouseCtl.js"}},"code":"let check, Match;\nmodule.link(\"meteor/check\", {\n  check(v) {\n    check = v;\n  },\n\n  Match(v) {\n    Match = v;\n  }\n\n}, 0);\nlet ValidatedMethod;\nmodule.link(\"meteor/mdg:validated-method\", {\n  ValidatedMethod(v) {\n    ValidatedMethod = v;\n  }\n\n}, 1);\nlet ResponseMessage;\nmodule.link(\"../../startup/server/utilities/ResponseMesssage\", {\n  ResponseMessage(v) {\n    ResponseMessage = v;\n  }\n\n}, 2);\nlet AuthGuard;\nmodule.link(\"../../middlewares/AuthGuard\", {\n  default(v) {\n    AuthGuard = v;\n  }\n\n}, 3);\nlet Permissions;\nmodule.link(\"../../startup/server/Permissions\", {\n  default(v) {\n    Permissions = v;\n  }\n\n}, 4);\nlet WarehouseRepository;\nmodule.link(\"./Warehouse\", {\n  WarehouseRepository(v) {\n    WarehouseRepository = v;\n  }\n\n}, 5);\nlet WarehouseServ;\nmodule.link(\"./WarehouseServ\", {\n  default(v) {\n    WarehouseServ = v;\n  }\n\n}, 6);\nnew ValidatedMethod({\n  name: 'warehouse.save',\n  mixins: [MethodHooks],\n  permissions: [Permissions.WAREHOUSES.CREATE.VALUE, Permissions.WAREHOUSES.UPDATE.VALUE],\n  beforeHooks: [AuthGuard.checkPermission],\n\n  validate(warehouse) {\n    try {\n      check(warehouse, {\n        _id: Match.OneOf(String, null),\n        name: String,\n        name_full: String,\n        location: String\n      });\n    } catch (exception) {\n      console.error('warehouse.save', exception);\n      throw new Meteor.Error('403', 'La informacion introducida no es valida');\n    } // Validar que no haya almacenes con el mismo nombre   \n\n\n    WarehouseServ.validateWarehouseName(warehouse.name, warehouse._id);\n  },\n\n  run(warehouse) {\n    const responseMessage = new ResponseMessage();\n\n    try {\n      if (warehouse._id !== null) {\n        WarehouseRepository.update(warehouse._id, {\n          $set: {\n            name: warehouse.name,\n            name_full: warehouse.name_full,\n            location: warehouse.location\n          }\n        });\n        responseMessage.create('Se actualiz贸 el almacen exitosamente');\n      } else {\n        WarehouseRepository.insert({\n          name: warehouse.name,\n          name_full: warehouse.name_full,\n          location: warehouse.location\n        });\n        responseMessage.create('Se insert贸 el almacen exitosamente');\n      }\n    } catch (exception) {\n      console.error('warehouse.save', exception);\n      throw new Meteor.Error('500', 'Ha ocurrido un error al guardar el almacen');\n    }\n\n    return responseMessage;\n  }\n\n});\nnew ValidatedMethod({\n  name: 'warehouse.delete',\n  mixins: [MethodHooks],\n  permissions: [Permissions.WAREHOUSES.DELETE.VALUE],\n  beforeHooks: [AuthGuard.checkPermission],\n  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n  afterHooks: [],\n\n  validate(_ref) {\n    let {\n      idWarehouse\n    } = _ref;\n\n    try {\n      console.log('idWarehouse ', idWarehouse);\n      check(idWarehouse, String);\n    } catch (exception) {\n      console.error('warehouse.delete', exception);\n      throw new Meteor.Error('403', 'Ocurrio un error al eliminar el almacen');\n    } // validar que no sea posible eliminar un almacen si hay un producto utilizandolo.\n\n\n    const warehouseWithProduct = WarehouseServ.validateWarehouseBusy(idWarehouse);\n\n    if (warehouseWithProduct > 0) {\n      throw new Meteor.Error('403', 'No es posible elimiar el almacen', 'Hay al menos un producto utilizandolo');\n    }\n  },\n\n  run(_ref2) {\n    let {\n      idWarehouse\n    } = _ref2;\n    const responseMessage = new ResponseMessage();\n\n    try {\n      WarehouseRepository.remove(idWarehouse);\n      responseMessage.create('Almacen eliminado exitosamente');\n    } catch (exception) {\n      console.error('warehouse.delete', exception);\n      throw new Meteor.Error('500', 'Ocurrio un error al eliminar el almacen');\n    }\n\n    return responseMessage;\n  }\n\n});","map":{"version":3,"sources":["imports/api/Warehouses/WarehouseCtl.js"],"names":["check","Match","module","link","v","ValidatedMethod","ResponseMessage","AuthGuard","default","Permissions","WarehouseRepository","WarehouseServ","name","mixins","MethodHooks","permissions","WAREHOUSES","CREATE","VALUE","UPDATE","beforeHooks","checkPermission","validate","warehouse","_id","OneOf","String","name_full","location","exception","console","error","Meteor","Error","validateWarehouseName","run","responseMessage","update","$set","create","insert","DELETE","afterHooks","idWarehouse","log","warehouseWithProduct","validateWarehouseBusy","remove"],"mappings":"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","sourcesContent":["import {check, Match} from \"meteor/check\";\nimport {ValidatedMethod} from 'meteor/mdg:validated-method';\nimport {ResponseMessage} from \"../../startup/server/utilities/ResponseMesssage\";\nimport AuthGuard from \"../../middlewares/AuthGuard\";\nimport Permissions from \"../../startup/server/Permissions\";\nimport {WarehouseRepository} from './Warehouse'\nimport WarehouseServ from \"./WarehouseServ\";\n\nnew ValidatedMethod({\n    name:'warehouse.save',\n     mixins:[MethodHooks],\n     permissions: [Permissions.WAREHOUSES.CREATE.VALUE,Permissions.WAREHOUSES.UPDATE.VALUE],  \n     beforeHooks: [AuthGuard.checkPermission],\n    validate(warehouse){\n        try {\n            \n            check(warehouse,{\n                _id: Match.OneOf(String, null),\n                name: String,\n                name_full: String,\n                location: String\n            });\n\n        }catch ( exception){\n            console.error('warehouse.save', exception);\n            throw new Meteor.Error('403', 'La informacion introducida no es valida');\n        }\n        // Validar que no haya almacenes con el mismo nombre   \n        \n        WarehouseServ.validateWarehouseName(warehouse.name,warehouse._id);\n    },\n    run(warehouse){\n        const responseMessage = new ResponseMessage(); \n        try {\n            if(warehouse._id !== null){\n                \n                WarehouseRepository.update(warehouse._id,{\n                    $set: {\n                    name: warehouse.name,\n                    name_full: warehouse.name_full,\n                    location: warehouse.location\n                    }\n                });\n                \n\n                responseMessage.create('Se actualiz贸 el almacen exitosamente');\n            }else{\n                WarehouseRepository.insert({\n                    name: warehouse.name,\n                    name_full: warehouse.name_full,\n                    location: warehouse.location\n                });\n\n                responseMessage.create('Se insert贸 el almacen exitosamente');\n            }\n        }catch ( exception){\n            console.error('warehouse.save', exception);\n            throw new Meteor.Error('500', 'Ha ocurrido un error al guardar el almacen');\n        }\n        return responseMessage;\n    }\n });\n\nnew ValidatedMethod({\n    name: 'warehouse.delete',\n    mixins: [MethodHooks],\n    permissions: [Permissions.WAREHOUSES.DELETE.VALUE],\n    beforeHooks: [AuthGuard.checkPermission],  // Aqui se verifica si los permisos de usuario son adecuados para esta accion\n    afterHooks: [],\n    validate({ idWarehouse }){\n        try {\n            console.log('idWarehouse ', idWarehouse);\n            check(idWarehouse , String);\n        }catch (exception) {\n            console.error('warehouse.delete', exception);\n            throw new Meteor.Error('403', 'Ocurrio un error al eliminar el almacen');\n        }\n        // validar que no sea posible eliminar un almacen si hay un producto utilizandolo.\n        const warehouseWithProduct = WarehouseServ.validateWarehouseBusy(idWarehouse);\n        if (warehouseWithProduct > 0){\n            throw new Meteor.Error('403','No es posible elimiar el almacen',\n                'Hay al menos un producto utilizandolo');\n        }\n    },\n    run({ idWarehouse }){\n        const responseMessage = new ResponseMessage();\n        try {\n            WarehouseRepository.remove(idWarehouse);\n                responseMessage.create('Almacen eliminado exitosamente');\n        }catch (exception) {\n            console.error('warehouse.delete', exception);\n            throw new Meteor.Error('500', 'Ocurrio un error al eliminar el almacen');\n        }\n\n        return responseMessage;\n    }\n});\n"]},"sourceType":"module","hash":"ba1a864a5b04ebdc0a85afdb54a8807bb6ef38b7"}
