{"code":"module.exportDefault = function(value) { __vue_script__ = value; }; (function(){var WarehouseRepository;\nmodule.link(\"../../../api/Warehouses/Warehouse\", {\n  WarehouseRepository: function (v) {\n    WarehouseRepository = v;\n  }\n}, 0);\nvar ProductionLineRepository;\nmodule.link(\"../../../api/ProductionLines/ProductionLine\", {\n  ProductionLineRepository: function (v) {\n    ProductionLineRepository = v;\n  }\n}, 1);\nvar Provider;\nmodule.link(\"../../../api/Providers/Provider\", {\n  Provider: function (v) {\n    Provider = v;\n  }\n}, 2);\nvar draggable;\nmodule.link(\"vuedraggable\", {\n  \"default\": function (v) {\n    draggable = v;\n  }\n}, 3);\nvar ModalBOM;\nmodule.link(\"./ModalBoM\", {\n  \"default\": function (v) {\n    ModalBOM = v;\n  }\n}, 4);\n// import ModalBOMProduct from \"./ModalBOMProduct\";\nvar id = 3;\nmodule.exportDefault({\n  name: \"SaveProduct\",\n  components: {\n    draggable: draggable,\n    ModalBOM: ModalBOM\n  },\n  data: function () {\n    return {\n      id: id,\n      productTempBOM: {},\n      product: {\n        _id: null,\n        name: '',\n        name_full: null,\n        unit: {\n          _id: null,\n          name: null\n        },\n        stock: null,\n        provider: {\n          _id: null,\n          name: null\n        },\n        location: null,\n        sku: null,\n        warehouse: {\n          _id: null,\n          name: null\n        },\n        production_line: {\n          _id: null,\n          name: null,\n          workstations: [{\n            _id: null,\n            name: null,\n            name_full: null,\n            location: null,\n            productionline: {\n              description: null,\n              name: null,\n              _id: null\n            }\n          }]\n        },\n        bom: [{\n          _id: '',\n          name: '',\n          quantity: ''\n        }],\n        isAvailable: false\n      },\n      rules: {\n        required: function (value) {\n          return !!value || 'Requerido.';\n        },\n        counter: function (value) {\n          return value.length <= 20 || 'Max 20 caracteres';\n        },\n        email: function (value) {\n          var pattern = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n          return pattern.test(value) || 'Correo Electrónico incorrecto.';\n        },\n        number: function (value) {\n          var pattern = /^[+-]?\\d+([,.]\\d+)?$/;\n          return pattern.test(value) || 'Numero con formato equivocado, debe ser un real Ejemplo: -123.35 o 7,4 o 8';\n        }\n      },\n      units: [{\n        _id: 'zzzzz',\n        name: 'Kgs'\n      }, {\n        _id: 'asasas',\n        name: 'Lbs'\n      }],\n      dataView: {\n        title: '',\n        targetButton: ''\n      },\n      headersBOMFilter: {\n        name: '',\n        quantity: ''\n      }\n    };\n  },\n  created: function () {\n    // Este es un metodo gancho, y se ejecuta cuando el HTML es creado\n    if (this.$router.currentRoute.name.includes(\"create\")) {\n      this.dataView.title = \"Crear producto\";\n      this.dataView.targetButton = \"Crear\";\n    } else if (this.$router.currentRoute.name.includes(\"edit\")) {\n      this.dataView.title = \"Editar producto\";\n      this.dataView.targetButton = \"Actualizar\";\n      var tempProduct = this.$store.state.temporal.element;\n      console.info('tempProduct', tempProduct);\n      this.product = {\n        _id: tempProduct._id,\n        name: tempProduct.name,\n        name_full: tempProduct.name_full,\n        unit: tempProduct.unit,\n        stock: tempProduct.stock,\n        sku: tempProduct.sku,\n        location: tempProduct.location,\n        warehouse: tempProduct.warehouse,\n        provider: tempProduct.provider,\n        bom: tempProduct.bom,\n        isAvailable: tempProduct.isAvailable,\n        production_line: tempProduct.production_line\n      };\n    }\n  },\n  methods: {\n    openModalBoM: function (product) {\n      // Aqui mandamos el objeto product\n      this.productTempBOM = product; // this.$refs.refModalBoM.dialog = true;\n\n      this.$refs.refModalBOMProduct.dialog = true;\n    },\n    setProductBoM: function (bomList) {\n      // Aqui fijar la lista a la variable BOM del producto\n      console.info('bomList ', bomList);\n      this.product.bom = bomList;\n    },\n    saveProduct: function () {\n      var _this = this;\n\n      this.$loader.activate('Guardando producto...');\n      Meteor.call('product.save', this.product, function (error, response) {\n        _this.$loader.deactivate();\n\n        if (error) {\n          _this.$alert.showAlertSimple('error', error.reason);\n        } else {\n          _this.$alert.showAlertSimple('success', response.message);\n\n          _this.$router.push({\n            name: 'home.products'\n          });\n        }\n      });\n    }\n  },\n  computed: {\n    headersBOMList: function () {\n      var _this2 = this;\n\n      return [{\n        value: 'quantity',\n        text: 'Cantidad',\n        sortable: true,\n        filter: function (value) {\n          return value != null && typeof value === 'string' && value.toString().toLocaleLowerCase().indexOf(_this2.headersBOMFilter.quantity.toLocaleLowerCase()) !== -1;\n        }\n      }, {\n        value: 'name',\n        text: 'Nombre',\n        sortable: true,\n        filter: function (value) {\n          return value != null && typeof value === 'string' && value.toString().toLocaleLowerCase().indexOf(_this2.headersBOMFilter.name.toLocaleLowerCase()) !== -1;\n        }\n      }, {\n        value: 'action',\n        text: 'Opciones',\n        sortable: false\n      }];\n    }\n  },\n  meteor: {\n    $subscribe: {\n      'productionlines.list': [],\n      'warehouse.list': [],\n      'provider.list': []\n    },\n    production_lines: function () {\n      return ProductionLineRepository.find({}, {\n        fields: {\n          _id: 1,\n          name: 1,\n          description: 1,\n          workstations: 1\n        }\n      }).fetch();\n    },\n    warehouses: function () {\n      var warehouses = WarehouseRepository.find({}, {\n        fields: {\n          _id: 1,\n          name: 1,\n          name_full: 1,\n          location: 1\n        }\n      }).fetch(); //console.info('Almacenes',warehouses);\n\n      return warehouses;\n    },\n    providers: function () {\n      return Provider.find({}, {\n        fields: {\n          _id: 1,\n          name: 1\n        }\n      }).fetch();\n    },\n    units: function () {\n      return this.units;\n    }\n  }\n});\n})();","map":{"version":3,"sources":["imports/ui/views/Products/SaveProduct.vue"],"names":["WarehouseRepository","module","link","v","ProductionLineRepository","Provider","draggable","ModalBOM","id","exportDefault","name","components","data","productTempBOM","product","_id","name_full","unit","stock","provider","location","sku","warehouse","production_line","workstations","productionline","description","bom","quantity","isAvailable","rules","required","value","counter","length","email","pattern","test","number","units","dataView","title","targetButton","headersBOMFilter","created","$router","currentRoute","includes","tempProduct","$store","state","temporal","element","console","info","methods","openModalBoM","$refs","refModalBOMProduct","dialog","setProductBoM","bomList","saveProduct","$loader","activate","Meteor","call","error","response","deactivate","$alert","showAlertSimple","reason","message","push","computed","headersBOMList","text","sortable","filter","toString","toLocaleLowerCase","indexOf","meteor","$subscribe","production_lines","find","fields","fetch","warehouses","providers"],"mappings":"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","sourcesContent":["<template>\n  <v-container>\n    <v-row>\n      <v-col>\n        <div class=\"headline\">{{dataView.title}}</div>\n      </v-col>\n      <v-col cols=\"2\">\n        <v-btn block type=\"submit\" form=\"saveProduct\" color=\"primary\" v-text=\"dataView.targetButton\">\n        </v-btn>\n      </v-col>\n    </v-row>\n    <v-row>\n      <v-col>\n        <v-card>\n          <v-card-text>\n            <v-form @submit.prevent=\"saveProduct\" id=\"saveProduct\" autocomplete=\"off\">\n              <v-row>\n                <v-col xs=\"12\" sm=\"12\" md=\"8\">\n                  <v-text-field\n                        v-model=\"product.name\" id=\"inputName\" name=\"name\"\n                        :rules=\"[rules.required, rules.counter]\"\n                        label=\"Nombre\"\n                        counter\n                        maxlength=\"20\"\n                  ></v-text-field>\n\n                  <v-text-field v-model=\"product.name_full\" id=\"inputNameFull\" name=\"name_full\" label=\"Nombre completo\">\n                  </v-text-field>\n\n                  <v-select v-model=\"product.unit\" id=\"selectUnit\" name=\"unit\"\n                            :items=\"units\"\n                            item-text=\"name\" item-value=\"_id\" return-object\n                            label=\"Unidad de medida\">\n                  </v-select>\n\n                  <v-text-field\n                    v-model=\"product.stock\" id=\"inputStock\" name=\"stock\" label=\"Existencia\"\n                    :rules=\"[rules.required, rules.number]\"\n                    \n                  ></v-text-field>\n\n                  <v-select v-model=\"product.provider\" id=\"selectProvider\" name=\"provider\"\n                            :items=\"providers\"\n                            item-text=\"name\" item-value=\"_id\" return-object\n                            label=\"Proveedor\">\n                  </v-select>\n                  \n\n                  <v-text-field v-model=\"product.location\" id=\"inputlocation\" name=\"location\" label=\"Ubicacion\">\n                  </v-text-field>\n                  <v-text-field v-model=\"product.sku\" id=\"inputsku\" name=\"sku\" label=\"SKU\">\n                  </v-text-field>\n                  <v-select v-model=\"product.warehouse\" id=\"selectWarehouse\" name=\"warehouse\"\n                            :items=\"warehouses\"\n                            item-text=\"name\" item-value=\"_id\" return-object\n                            label=\"Almacen\">\n                  </v-select>\n                  <v-select v-model=\"product.provider\" id=\"selectProvider\" name=\"provider\"\n                            :items=\"providers\"\n                            item-text=\"name\" item-value=\"_id\" return-object\n                            label=\"Proveedor\">\n                  </v-select>\n                  <v-select v-model=\"product.production_line\" id=\"selectProductionLine\" name=\"productionline\"\n                            :items=\"production_lines\"\n                            item-text=\"name\" item-value=\"_id\" return-object\n                            label=\"Linea de produccion\">\n                  </v-select>\n                  <td>\n                    <v-switch\n                        v-model=\"product.isAvailable\"\n                        label=\"¿Habilitar producto?\"\n                        color=\"indigo\"\n                        hide-details\n                    ></v-switch>\n                  </td>\n                  <v-btn\n                    depressed\n                    color=\"primary\"\n                    @click=\"openModalBoM(product)\"\n                  >\n                    Configurar componentes del producto\n                  </v-btn>\n                  \n                  <td>\n                  </td>\n                </v-col>\n                <v-col\n                cols=\"24\"\n                sm=\"12\"\n              >\n              <span class=\"headline\">Lista de articulos del producto</span>\n                <v-data-table :headers=\"headersBOMList\" :items=\"product.bom\" \n                      sort-by=\"name\" \n                      class=\"elevation-1\">\n\n                      <template v-slot:item.action=\"{item}\">\n                            <v-tooltip bottom>\n                              <template v-slot:activator=\"{on}\">\n                                <v-icon v-can:delete.hide=\"'product.bom'\" color=\"error\" v-on=\"on\" small class=\"mr-2\" @click=\"removeItemFromproductBOM(item)\">\n                                  delete\n                                </v-icon>\n                              </template>\n                              <span>Eliminar</span>\n                            </v-tooltip>\n                      </template>\n                        \n                </v-data-table>\n              </v-col>\n              </v-row>\n            </v-form>\n          </v-card-text>\n        </v-card>\n      </v-col>\n    </v-row>\n    <modal-bOM ref=\"refModalBoM\" v-bind:modalData=\"productTempBOM\"\n                  @bomList=\"setProductBoM\">\n    </modal-bOM>\n    <modal-product ref=\"refModalBOMProduct\" v-bind:modalData=\"productTempBOM\"\n                  @bomList=\"setProductBoM\">\n    </modal-product>\n  </v-container>\n  \n</template>\n\n<script>\nimport {WarehouseRepository} from \"../../../api/Warehouses/Warehouse\";\nimport {ProductionLineRepository} from \"../../../api/ProductionLines/ProductionLine\";\nimport {Provider} from \"../../../api/Providers/Provider\";\nimport draggable from 'vuedraggable';\nimport ModalBOM from \"./ModalBoM\";\n// import ModalBOMProduct from \"./ModalBOMProduct\";\n\nlet id = 3;\nexport default {\n  name: \"SaveProduct\",\n  components: {\n    draggable,\n    ModalBOM\n  },\n  data() {\n    return {\n      id,\n      productTempBOM: {\n      },\n      product: {\n                _id: null,\n                name: '',\n                name_full: null,\n                unit: {\n                    _id: null,\n                    name: null\n                },\n                stock: null\n                ,\n                provider: {\n                    _id: null,\n                    name: null\n                },\n                location: null,\n                sku: null,\n                warehouse: {\n                    _id: null,\n                    name: null\n                },\n                production_line: {\n                    _id: null,\n                    name: null,\n                    workstations: [\n                        {\n                            _id: null,\n                            name: null,\n                            name_full: null,\n                            location: null,\n                            productionline: {\n                                description : null,\n                                name : null,\n                                _id : null\n                            }\n                        }\n                    ]\n                } ,\n                bom:[\n                  {\n                  _id:'',\n                  name:'',\n                  quantity:''\n                  }\n                 \n                ],\n                isAvailable: false\n      },\n      rules: {\n          required: value => !!value || 'Requerido.',\n          counter: value => value.length <= 20 || 'Max 20 caracteres',\n          email: value => {\n            const pattern = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\n            return pattern.test(value) || 'Correo Electrónico incorrecto.'\n          },\n          number: value => {\n            const pattern= /^[+-]?\\d+([,.]\\d+)?$/\n            return pattern.test(value) || 'Numero con formato equivocado, debe ser un real Ejemplo: -123.35 o 7,4 o 8'\n          }\n      },\n      units:[\n          {\n            _id: 'zzzzz',\n            name: 'Kgs'\n          },\n          {\n            _id: 'asasas',\n            name: 'Lbs'\n          }\n        \n        ],\n      dataView: {\n        title: '',\n        targetButton: ''\n      },\n      headersBOMFilter:{\n              name: '',\n              quantity: ''\n          }\n    }\n  },\n  created(){  // Este es un metodo gancho, y se ejecuta cuando el HTML es creado\n    if(this.$router.currentRoute.name.includes(\"create\")){\n      this.dataView.title=\"Crear producto\";\n      this.dataView.targetButton=\"Crear\";\n      \n    }else if(this.$router.currentRoute.name.includes(\"edit\")){\n      this.dataView.title=\"Editar producto\";\n      this.dataView.targetButton=\"Actualizar\";\n      const tempProduct=this.$store.state.temporal.element;\n      console.info('tempProduct',tempProduct);\n      this.product= {\n        _id: tempProduct._id,\n        name: tempProduct.name,\n        name_full: tempProduct.name_full,\n        unit: tempProduct.unit,\n        stock: tempProduct.stock,\n        sku: tempProduct.sku,\n        location: tempProduct.location,\n        warehouse: tempProduct.warehouse,\n        provider: tempProduct.provider,\n        bom: tempProduct.bom,\n        isAvailable: tempProduct.isAvailable,\n        production_line: tempProduct.production_line\n      };\n     \n    }\n  },\n  methods: {\n    openModalBoM(product) {  \n      // Aqui mandamos el objeto product\n       this.productTempBOM = product;\n      // this.$refs.refModalBoM.dialog = true;\n      this.$refs.refModalBOMProduct.dialog= true;\n\n    },\n    setProductBoM(bomList){\n      // Aqui fijar la lista a la variable BOM del producto\n      console.info('bomList ', bomList);\n      this.product.bom=bomList;\n    },\n    saveProduct() {\n      this.$loader.activate('Guardando producto...');\n      \n      Meteor.call('product.save',this.product,(error,response) => {\n        this.$loader.deactivate();\n        if(error){\n              this.$alert.showAlertSimple('error',error.reason);\n        }else{\n          this.$alert.showAlertSimple('success',response.message);\n          this.$router.push({name: 'home.products'});\n        }\n      });\n    }\n  },\n  computed:{\n          headersBOMList() {\n            return [\n              {\n                value: 'quantity', text: 'Cantidad', sortable: true, filter: value => {\n                  return value != null && typeof value === 'string' &&\n                      value.toString().toLocaleLowerCase()\n                          .indexOf(this.headersBOMFilter.quantity.toLocaleLowerCase()) !== -1;\n                }\n              },\n              {\n                value: 'name', text: 'Nombre', sortable: true, filter: value => {\n                  return value != null && typeof value === 'string' &&\n                      value.toString().toLocaleLowerCase()\n                          .indexOf(this.headersBOMFilter.name.toLocaleLowerCase()) !== -1;\n                }\n              }\n              ,\n              {value: 'action', text: 'Opciones', sortable: false}\n            ]\n          }\n  },\n  meteor:{\n    \n    $subscribe: {\n        'productionlines.list': [],\n        'warehouse.list': [],\n        'provider.list' : []\n    },\n    production_lines(){\n      return ProductionLineRepository.find({},{fields:{_id:1,name:1,description:1,workstations:1}}).fetch();\n    },\n    warehouses(){\n      const warehouses= WarehouseRepository.find({},{fields:{_id:1,name:1,name_full:1,location:1}}).fetch();\n      //console.info('Almacenes',warehouses);\n      return warehouses;\n    },\n    providers(){\n      return Provider.find({},{fields:{_id:1,name:1}}).fetch();\n    },\n    units(){\n      return this.units;\n    }\n  }\n}\n</script>\n\n<style scoped>\n.button {\n  margin-top: 35px;\n}\n.handle {\n  float: left;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\n.close {\n  float: right;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\ninput {\n  display: inline-block;\n  width: 50%;\n}\n.text {\n  margin: 20px;\n}\n</style>"],"file":"imports/ui/views/Products/SaveProduct.vue"},"styles":[{"css":"\n.button[data-v-4cd4c87e] {\n  margin-top: 35px;\n}\n.handle[data-v-4cd4c87e] {\n  float: left;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\n.close[data-v-4cd4c87e] {\n  float: right;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\ninput[data-v-4cd4c87e] {\n  display: inline-block;\n  width: 50%;\n}\n.text[data-v-4cd4c87e] {\n  margin: 20px;\n}\n","map":{"version":3,"sources":["SaveProduct.vue"],"names":[],"mappings":";AACA;EACE,gBAAgB;AAClB;AACA;EACE,WAAW;EACX,gBAAgB;EAChB,mBAAmB;AACrB;AACA;EACE,YAAY;EACZ,gBAAgB;EAChB,mBAAmB;AACrB;AACA;EACE,qBAAqB;EACrB,UAAU;AACZ;AACA;EACE,YAAY;AACd","file":"SaveProduct.vue","sourcesContent":["\n.button {\n  margin-top: 35px;\n}\n.handle {\n  float: left;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\n.close {\n  float: right;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\ninput {\n  display: inline-block;\n  width: 50%;\n}\n.text {\n  margin: 20px;\n}\n"]}}],"template":"\n<v-container>\n  <v-row>\n    <v-col>\n      <div class=\"headline\">{{dataView.title}}</div>\n    </v-col>\n    <v-col cols=\"2\">\n      <v-btn block type=\"submit\" form=\"saveProduct\" color=\"primary\" v-text=\"dataView.targetButton\">\n      </v-btn>\n    </v-col>\n  </v-row>\n  <v-row>\n    <v-col>\n      <v-card>\n        <v-card-text>\n          <v-form @submit.prevent=\"saveProduct\" id=\"saveProduct\" autocomplete=\"off\">\n            <v-row>\n              <v-col xs=\"12\" sm=\"12\" md=\"8\">\n                <v-text-field\n                      v-model=\"product.name\" id=\"inputName\" name=\"name\"\n                      :rules=\"[rules.required, rules.counter]\"\n                      label=\"Nombre\"\n                      counter\n                      maxlength=\"20\"\n                ></v-text-field>\n\n                <v-text-field v-model=\"product.name_full\" id=\"inputNameFull\" name=\"name_full\" label=\"Nombre completo\">\n                </v-text-field>\n\n                <v-select v-model=\"product.unit\" id=\"selectUnit\" name=\"unit\"\n                          :items=\"units\"\n                          item-text=\"name\" item-value=\"_id\" return-object\n                          label=\"Unidad de medida\">\n                </v-select>\n\n                <v-text-field\n                  v-model=\"product.stock\" id=\"inputStock\" name=\"stock\" label=\"Existencia\"\n                  :rules=\"[rules.required, rules.number]\"\n                  \n                ></v-text-field>\n\n                <v-select v-model=\"product.provider\" id=\"selectProvider\" name=\"provider\"\n                          :items=\"providers\"\n                          item-text=\"name\" item-value=\"_id\" return-object\n                          label=\"Proveedor\">\n                </v-select>\n                \n\n                <v-text-field v-model=\"product.location\" id=\"inputlocation\" name=\"location\" label=\"Ubicacion\">\n                </v-text-field>\n                <v-text-field v-model=\"product.sku\" id=\"inputsku\" name=\"sku\" label=\"SKU\">\n                </v-text-field>\n                <v-select v-model=\"product.warehouse\" id=\"selectWarehouse\" name=\"warehouse\"\n                          :items=\"warehouses\"\n                          item-text=\"name\" item-value=\"_id\" return-object\n                          label=\"Almacen\">\n                </v-select>\n                <v-select v-model=\"product.provider\" id=\"selectProvider\" name=\"provider\"\n                          :items=\"providers\"\n                          item-text=\"name\" item-value=\"_id\" return-object\n                          label=\"Proveedor\">\n                </v-select>\n                <v-select v-model=\"product.production_line\" id=\"selectProductionLine\" name=\"productionline\"\n                          :items=\"production_lines\"\n                          item-text=\"name\" item-value=\"_id\" return-object\n                          label=\"Linea de produccion\">\n                </v-select>\n                <td>\n                  <v-switch\n                      v-model=\"product.isAvailable\"\n                      label=\"¿Habilitar producto?\"\n                      color=\"indigo\"\n                      hide-details\n                  ></v-switch>\n                </td>\n                <v-btn\n                  depressed\n                  color=\"primary\"\n                  @click=\"openModalBoM(product)\"\n                >\n                  Configurar componentes del producto\n                </v-btn>\n                \n                <td>\n                </td>\n              </v-col>\n              <v-col\n              cols=\"24\"\n              sm=\"12\"\n            >\n            <span class=\"headline\">Lista de articulos del producto</span>\n              <v-data-table :headers=\"headersBOMList\" :items=\"product.bom\" \n                    sort-by=\"name\" \n                    class=\"elevation-1\">\n\n                    <template v-slot:item.action=\"{item}\">\n                          <v-tooltip bottom>\n                            <template v-slot:activator=\"{on}\">\n                              <v-icon v-can:delete.hide=\"'product.bom'\" color=\"error\" v-on=\"on\" small class=\"mr-2\" @click=\"removeItemFromproductBOM(item)\">\n                                delete\n                              </v-icon>\n                            </template>\n                            <span>Eliminar</span>\n                          </v-tooltip>\n                    </template>\n                      \n              </v-data-table>\n            </v-col>\n            </v-row>\n          </v-form>\n        </v-card-text>\n      </v-card>\n    </v-col>\n  </v-row>\n  <modal-bOM ref=\"refModalBoM\" v-bind:modalData=\"productTempBOM\"\n                @bomList=\"setProductBoM\">\n  </modal-bOM>\n  <modal-product ref=\"refModalBOMProduct\" v-bind:modalData=\"productTempBOM\"\n                @bomList=\"setProductBoM\">\n  </modal-product>\n</v-container>\n\n","hash":"data-v-4cd4c87e"}