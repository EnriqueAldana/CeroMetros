
Prerequisitos

My SQl debera modificarse una columna por tabla para actualizar timestamp.
CREATE TABLE foo (
        …
        UPDATE_TS TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
Script
ALTER TABLE tosolicitud  ADD UPDATE_TS TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;


Uso de Kafka para traer los regisstros de MySql a mongo DB en tiempo real

Postgress a MySQL
https://youtu.be/jmE4y6pLGOI

Postgress a Kafka
https://www.youtube.com/watch?v=zmR8xLy8FkA


Procedimiento.

1.- Instalar Kafka
https://kafka.apache.org/downloads
2.- ejecutar
bin/zookeeper-server-start.sh config/zookeeper.properties
bin/kafka-server-start.sh config/server.properties
3.- Probar funcionalidad
    3.1 Crear un topico
    bin/kafka-topics.sh --create --partitions 1 --replication-factor 1 --topic cerometros --bootstrap-server localhost:9092
    3.2 Listar topicos
    bin/kafka-topics.sh --list --bootstrap-server localhost:9092
    3.3 Escibir un mensaje
    bin/kafka-console-producer.sh --topic cerometros --bootstrap-server localhost:9092
    3.4 Leeer un mensaje
     bin/kafka-console-consumer.sh --topic cerometros --from-beginning --bootstrap-server localhost:9092

4.- Levantar el componente Connect en modo distribuido
    ./bin/connect-distributed.sh  ./config/connect-distributed.properties

5.- Comprobar que los conectores esten reconocidos
    http:localhost:8083/connector-plugins
6.- Crear un conector mediante POSTMAN
    tipo : POST
    URL : http://localhost:8083/connectors
    BODY - RAW - JSON
    {
    "name": "CeroMts-MySql-jdbc-connector",
    "config":{
        "connector.class": "io.confluent.connect.jdbc.JdbcSourceConnector",
        "tasks.max": "2",
        "connection.url": "jdbc:mysql://mysql/sccsc2?user=ceromts&password=ceromts",
        "table.whitelist":"tosolicitud",
        "mode": "timestamp+incrementing",
        "incrementing.column.name": "IdSolicitud",
        "timestamp.column.name": "EstatusSolicitud",
        "topic.prefix": "tosolicitud-"
    }
}

5.- Crear un worker utilizando conexiones
    4.1 Configuracion del worker mediante un archivo

    4.2 Arrancar el conector connect
    bin/connect-standalone.sh -daemon config/connect-standalone-mysql-cerometros.properties config/connect-mysql-bulk-source.properties
    4.3 verificar la conexion del conector